# Environment Config

# store your secrets and config variables in here
# only invited collaborators will be able to see your .env values
# Note: comments will be visible to remixes so don't put secrets in comments!

# reference these in your code with process.env.SECRET


# note: .env is a shell file so there can't be spaces around =
 # Scrubbed by Glitch 2020-10-23T18:59:48+0000
 # Scrubbed by Glitch 2021-04-19T14:02:17+0000
 # Scrubbed by Glitch 2021-06-25T21:09:04+0000
 # Scrubbed by Glitch 2024-06-05T17:42:10+0000

IP=146.52.36.136,77.23.91.183
SECRET_FILE=./rabakala.js
YE="clients.push(ws);   ws.ip = req.headers['x-forwarded-for'].split(',')[0];   console.log(ws.ip);   ws.spamWarnings = 0; ws.developer = req.headers['x-forwarded-for'].split(',')[0] === process.env.IP"
e="<h1>Hello, WebSocket!</h1>     <p>This is a websocket + http server example.</p>"
EY="setInterval(() => { requests = []; }, 200);"
OI="setInterval(() => {   ws.spam = false;   }, 300);     console.log('New client connected');"
pls="if (req.headers.origin !== 'https://chat-lol.glitch.me' && req.headers.origin !== 'http://chat-lol.glitch.me' && req.headers.origin !== 'https://chat-lol.glitch.me/' && req.headers.origin !== 'http://chat-lol.glitch.me/') {   ws._socket.pause();   console.log('Hey Esclippy whos this?? Pls check this link cuz i got a connection from it: ' + req.headers.origin);   }"
stfu="if (blackListed.includes(req.headers['x-forwarded-for'].split(',')[0])) {\nws.send(JSON.stringify({type: 'blacklist'}));\n   }\n   eval(process.env.pls)\n   eval(process.env.YE)\n   if (mutedIPS.includes(req.headers['x-forwarded-for'].split(',')[0])) {\n   ws.send(JSON.stringify({type: 'mute'}))\n   let m = setInterval(() => {\n   try {\n   if (!mutedIPS.includes(req.headers['x-forwarded-for'].split(',')[0])) {\n   ws.send(JSON.stringify({type: 'mute'}))\n   clearInterval(m);\n   } \n  } catch (error) {console.error(error); clearInterval(m)}\n   }, 0);\n   }"
bansuggest=
BAN=45.11.203.51
code="Y29uc3QgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTsKY29uc3QgV2ViU29ja2V0ID0gcmVxdWlyZSgnd3MnKTsKbGV0IGNyYXNoID0gZmFsc2U7CmxldCBkYmNyYXNoID0gZmFsc2U7CmNvbnN0IGRiID0gbmV3IFdlYlNvY2tldChwcm9jZXNzLmVudi51cmwpOyAvLyBOb3cgZGF0YWJhc2UgaXMgbWFkZSA6KQpkYi5vbignZXJycm9yJywgKCkgPT4gewpkYmNyYXNoID0gdHJ1ZTsKc2V0VGltZW91dCgoKSA9PiB7CnByb2Nlc3MuZXhpdCgxKQp9LCAzMDAwMCk7CmNvbnN0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKChyZXEsIHJlcykgPT4gewogICAgaWYgKGRiY3Jhc2ggPT09IHRydWUgJiYgY3Jhc2ggPT09IGZhbHNlKSB7CiAgICByZXMuZW5kKGAKICAgIDxzdHlsZT4KYm9keSB7CmZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOwp9Cjwvc3R5bGU+CjxjZW50ZXI+CjxoMT5TZXJ2ZXIgaXMgZG93biA8Zm9udCBzaXplPSIzIj48c3BhbiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogbGlnaHRncmV5OyBib3JkZXItcmFkaXVzOiAzcHg7Ij5FcnJvcjogdmlld19zaXRlX2Vycm9yPC9zcGFuPjwvZm9udD48L2gxPgoKPGgyPjxmb250IGNvbG9yPSJncmVlbiI+WW91PC9mb250PiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0+IDxmb250IGNvbG9yPSJncmVlbiI+U2VydmVyPC9mb250PiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0+IDxmb250IGNvbG9yPSJncmVlbiI+Q29ubmVjdGlvbjwvZm9udD4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiA8Zm9udCBjb2xvcj0icmVkIj48dT5DaGF0cm9vbTwvdT48L2ZvbnQ+PC9oMj4KPGZvbnQgc2l6ZT0iNCI+CjxwPlRoYW5rIHlvdSBmb3IgdXNpbmcgb3VyIGNoYXRyb29tITwvcD4KPHA+PGI+V2hhdCB3ZW50IHdyb25nPzwvYj48L3A+CjxwPlRoZSBjb25uZWN0aW9uIGVzdGFibGlzaGVkIGJ5IHRoZSBjaGF0cm9vbSB3YXMgYWJydXB0bHkgY2xvc2VkLjwvcD4KPHA+VGhpcyBlcnJvciBtaWdodCBiZSB0ZW1wb3JhcnksIGFuZCB3aWxsIGJlIGZpeGVkIGFzIHNvb24gYXMgcG9zc2libGUuPC9wPgo8cD48YnI+VGhlIHNlcnZlciB3aWxsIHJlc3RhcnQgZXZlcnkgMzAgc2Vjb25kcyB0byBzdGF5IHVwZGF0ZWQgYWJvdXQgdGhlIG9uZ29pbmcgZXJyb3IuPC9wPgo8cD48Yj5UaW1lc3RhbXA6PC9iPiA8aW5wdXQgdmFsdWU9IiR7RGF0ZSgpLnN1YnN0cmluZygwLCAzMyl9IiBzaXplPSIzMCI+PC9wPgo8L2ZvbnQ+CjwvY2VudGVyPgogICAgYCkKICAgIH19KQpzZXJ2ZXIubGlzdGVuKDMwMDAsICgpID0+IHsKICAgIC8vIFlFQUhISEhISEhISEhISFtISEhISEhISEhISEhISEhISEhISEhISEgKICAgIGNvbnNvbGUubG9nKCdIdHRwIGVycm9yIHNlcnZlciB0dXJuZWQgb24uLi4nKTsKfSk7Cn0pCnByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uJywgKGVycikgPT4gewppZiAoZGJjcmFzaCA9PT0gZmFsc2UgJiYgY3Jhc2ggPT09IGZhbHNlKSB7CmNyYXNoID0gdHJ1ZTsKc2V0VGltZW91dCgoKSA9PiB7CnByb2Nlc3MuZXhpdCgxKQp9LCAzMDAwMCk7CmNvbnNvbGUubG9nKCd5ZXAnKQoKY29uc3Qgc2VydmVyID0gaHR0cC5jcmVhdGVTZXJ2ZXIoKHJlcSwgcmVzKSA9PiB7CiAgICBpZiAoY3Jhc2ggPT09IHRydWUpIHsKICAgIHJlcy5lbmQoYAogICAgPHN0eWxlPgpib2R5IHsKZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7Cn0KPC9zdHlsZT4KPGNlbnRlcj4KPGgxPlNlcnZlciBpcyBkb3duIDxmb250IHNpemU9IjMiPjxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiBsaWdodGdyZXk7IGJvcmRlci1yYWRpdXM6IDNweDsiPkVycm9yOiBjb25uZWN0aW9uX2ZvcmJpZGRlbjwvc3Bhbj48L2ZvbnQ+PC9oMT4KCjxoMj48Zm9udCBjb2xvcj0iZ3JlZW4iPllvdTwvZm9udD4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiA8Zm9udCBjb2xvcj0iZ3JlZW4iPlNlcnZlcjwvZm9udD4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiA8Zm9udCBjb2xvcj0icmVkIj48dT5Db25uZWN0aW9uPC91PjwvZm9udD4gLS0tLS0tLS0tLS0tLS0tLS0tLS0tPiBDaGF0cm9vbTwvaDI+Cjxmb250IHNpemU9IjQiPgo8cD5UaGFuayB5b3UgZm9yIHVzaW5nIG91ciBjaGF0cm9vbSE8L3A+CjxwPjxiPldoYXQgd2VudCB3cm9uZz88L2I+PC9wPgo8cD5Tb21ldGhpbmcgaGFzIHdlbnQgd3Jvbmcgd2hpbGUgdHJ5aW5nIHRvIHByZXBhcmUgdGhlIGNvbm5lY3Rpb24gZm9yIHRoZSBjaGF0cm9vbSwgcmVzdWx0aW5nIGluIHRoZSBjaGF0cm9vbSBub3QgZGlzcGxheWluZy48L3A+CjxwPlRoaXMgZXJyb3IgbWlnaHQgYmUgdGVtcG9yYXJ5LCBhbmQgd2lsbCBiZSBmaXhlZCBhcyBzb29uIGFzIHBvc3NpYmxlLjwvcD4KPHA+PGJyPlRoZSBzZXJ2ZXIgd2lsbCByZXN0YXJ0IGV2ZXJ5IDMwIHNlY29uZHMgdG8gc3RheSB1cGRhdGVkIGFib3V0IHRoZSBvbmdvaW5nIGVycm9yLjwvcD4KPHA+PGI+VGltZXN0YW1wOjwvYj4gPGlucHV0IHZhbHVlPSIke0RhdGUoKS5zdWJzdHJpbmcoMCwgMzMpfSIgc2l6ZT0iMzAiPjwvcD4KPC9mb250Pgo8L2NlbnRlcj4KICAgIGApCiAgICB9fSkKc2VydmVyLmxpc3RlbigzMDAwLCAoKSA9PiB7CiAgICAvLyBZRUFISEhISEhISEhISEhbSEhISEhISEhISEhISEhISEhISEhISEhICiAgICBjb25zb2xlLmxvZygnSHR0cCBlcnJvciBzZXJ2ZXIgdHVybmVkIG9uLi4uJyk7Cn0pOwp9Cn0pCmRiLm9uKCdvcGVuJywgKCkgPT4gewpsZXQgYSA9ICJFeGFtcGxlIFRleHQiOwpsZXQgY2xpZW50cyA9IFtdOwpsZXQgY2hhdHMgPSBbJ21haW4nXTsKbGV0IGNoYXRJUHMgPSBbXQpsZXQgbXV0ZWRJUFMgPSBbXTsKbGV0IHVzZXJzID0gW107CmxldCB0ZW1wYmFubmVkID0gW107CmxldCB2ZXJpZmllZCA9IFtdOwpsZXQgdGhyZWF0ID0gW107CmxldCB7IGJsYWNrTGlzdGVkIH0gPSByZXF1aXJlKHByb2Nlc3MuZW52LlNFQ1JFVF9GSUxFKTsKbGV0IG1zZ3MgPSBbXTsKbGV0IHJlcXVlc3RzID0gW3Byb2Nlc3MuZW52LkJBTl0Kc2V0SW50ZXJ2YWwoKCkgPT4gewogcmVxdWVzdHMgPSBbXTsKIH0sIDIwMCk7CmZ1bmN0aW9uIGNsZWFyQ2hhdCgpIHsKbXNncyA9IFtdOwp9CgpmdW5jdGlvbiBicm9hZGNhc3QobWVzc2FnZSwgY2hhdCwgYywgaWQpIHsKbXNncy5wdXNoKG1lc3NhZ2UpCi8qY29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwpmcy53cml0ZUZpbGUocHJvY2Vzcy5lbnYuU0VDUkVUX0ZJTEUsIGBleHBvcnRzLm1zZ3MgPSAke0pTT04uc3RyaW5naWZ5KG1zZ3MpfQovLyBUaGlzIGlzIGEgc2VydmVyLWdlbmVyYXRlZCBmaWxlLiBEbyBub3QgbW9kaWZ5IGFueXRoaW5nIGluIHRoaXMgZmlsZSwgYXMgaXQgbWF5IGJyZWFrIHRoZSBjaGF0IHN5c3RlbS5gLCAoZXJyKSA9PiB7Cn0pKi8KZGIuc2VuZCgnKipDaGF0OioqICcrY2hhdCsnLCAqKkludmlzaWJsZSBieSBleGVjdXRvcioqOiAnK2MrJywgJytTdHJpbmcobWVzc2FnZSkpOwppZiAoYyA9PT0gdHJ1ZSkgewpmb3IgKGxldCB3ZWJzb2NrZXQgb2YgY2xpZW50cykgewp0cnkgewppZiAoaWQpIHsKaWYgKHdlYnNvY2tldC5jaGF0ID09PSBjaGF0ICYmIHdlYnNvY2tldC5pZCAhPT0gaWQpIHsKd2Vic29ja2V0LnNlbmQobWVzc2FnZSkKfQp9Cn0gY2F0Y2ggKGVycm9yKSB7fSAvLyBFcnJvcjogaWQgaXMgbm90IGRlZmluZWQsIGRvbid0IHdhbnQgdGhhdCBwZXR0eSBlcnJvciB3aGljaCB3aWxsIGNyYXNoIHRoZSB3aG9sZSBzZXJ2ZXIgaW4gYSBzbmFwCn0KfSBlbHNlIHsKZm9yIChsZXQgd2Vic29ja2V0IG9mIGNsaWVudHMpIHsKaWYgKHdlYnNvY2tldC5jaGF0ID09PSBjaGF0KSB7CndlYnNvY2tldC5zZW5kKG1lc3NhZ2UpCn0KfQp9Cn0KLy8gQ3JlYXRlIGFuIEhUVFAgc2VydmVyCmNvbnN0IHNlcnZlciA9IGh0dHAuY3JlYXRlU2VydmVyKChyZXEsIHJlcykgPT4gewogICAgaWYgKGNyYXNoID09PSB0cnVlKSB7CiAgICByZXMuZW5kKGAKICAgIDxzdHlsZT4KYm9keSB7CmZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOwp9Cjwvc3R5bGU+CjxjZW50ZXI+CjxoMT5TZXJ2ZXIgaXMgZG93biA8Zm9udCBzaXplPSIzIj48c3BhbiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogbGlnaHRncmV5OyBib3JkZXItcmFkaXVzOiAzcHg7Ij5FcnJvcjogY29ubmVjdGlvbl9mb3JiaWRkZW48L3NwYW4+PC9mb250PjwvaDE+Cgo8aDI+PGZvbnQgY29sb3I9ImdyZWVuIj5Zb3U8L2ZvbnQ+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLT4gPGZvbnQgY29sb3I9ImdyZWVuIj5TZXJ2ZXI8L2ZvbnQ+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLT4gPGZvbnQgY29sb3I9InJlZCI+PHU+Q29ubmVjdGlvbjwvdT48L2ZvbnQ+IC0tLS0tLS0tLS0tLS0tLS0tLS0tLT4gQ2hhdHJvb208L2gyPgo8Zm9udCBzaXplPSI0Ij4KPHA+VGhhbmsgeW91IGZvciB1c2luZyBvdXIgY2hhdHJvb20hPC9wPgo8cD48Yj5XaGF0IHdlbnQgd3Jvbmc/PC9iPjwvcD4KPHA+U29tZXRoaW5nIGhhcyB3ZW50IHdyb25nIHdoaWxlIHRyeWluZyB0byBwcmVwYXJlIHRoZSBjb25uZWN0aW9uIGZvciB0aGUgY2hhdHJvb20sIHJlc3VsdGluZyBpbiB0aGUgY2hhdHJvb20gbm90IGRpc3BsYXlpbmcuPC9wPgo8cD5UaGlzIGVycm9yIG1pZ2h0IGJlIHRlbXBvcmFyeSwgYW5kIHdpbGwgYmUgZml4ZWQgYXMgc29vbiBhcyBwb3NzaWJsZS48L3A+CjxwPjxicj5UaGUgc2VydmVyIHdpbGwgcmVzdGFydCBldmVyeSAzMCBzZWNvbmRzIHRvIHN0YXkgdXBkYXRlZCBhYm91dCB0aGUgb25nb2luZyBlcnJvci48L3A+CjxwPjxiPlRpbWVzdGFtcDo8L2I+IDxpbnB1dCB2YWx1ZT0iJHtEYXRlKCkuc3Vic3RyaW5nKDAsIDMzKX0iIHNpemU9IjMwIj48L3A+CjwvZm9udD4KPC9jZW50ZXI+CiAgICBgKQogICAgfSBlbHNlIGlmIChmYWxzZSkgewogICAgcmVzLndyaXRlSGVhZCg0MDEpCiAgICByZXMuZW5kKCdUaGlzIHdlYnNpdGUgaXMgbm8gbG9uZ2VyIGF2YWlsYWJsZSBkdWUgdG8gYmVpbmcgaGlnaGx5IG91dGRhdGVkLiBWZXJzaW9uOiAoMTcgSnVseSwgMjAyNCA+IDMgTWF5LCAyMDI0KScpCiAgICB9IGVsc2UgaWYgKHJlcXVlc3RzLmluY2x1ZGVzKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKSkgewogICAgcmVzLndyaXRlSGVhZCg0MDMpOwogICAgcmVzLmVuZChgPCFET0NUWVBFIGh0bWw+CiAgICA8c3R5bGU+Ym9keXtmb250LWZhbWlseTpzYW5zLXNlcmlmO308L3N0eWxlPgogICAgPGNlbnRlcj4KICAgIDxoMT40MDMgRm9yYmlkZGVuPC9oMT4KICAgIFRoaXMgd2Vic2l0ZSBoYXMgcmVjaWV2ZWQgdG9vIG1hbnkgcmVxdWVzdHMgZnJvbSB5b3VyIElQLiBQbGVhc2UgdHJ5IGFnYWluIGxhdGVyLgogICAgPC9jZW50ZXI+YCkKICAgIH0gZWxzZSBpZiAocmVxLnVybCA9PT0gJy9iYW4tYXBwZWFscycpIHsKICAgIGlmIChyZXEubWV0aG9kID09PSAnUE9TVCcpIHsKICAgIGNvbnNvbGUubG9nKCdnb3QgaXQhJykKICAgIGRiLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdhcHBlYWwnLCBuYW1lOiByZXEuaGVhZGVyc1sncmVhc29uJ10sIHRleHQ6IHJlcS5oZWFkZXJzWyd3aHknXSwgaXA6IHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdfSkpCiAgICBkYi5zZW5kKCcqKlNvbWVvbmUgYXBwZWFsZWQgYSBiYW4qKicpCiAgICB9CiAgICBsZXQgYWxwaGFiZXQgPSBbJ2EnLCdiJywnYycsJ2QnLCdlJywnZicsJ2cnLCdoJywnaScsJ2onLCdrJywnbCcsJ20nLCduJywnbycsJ3AnLCdxJywncicsJ3MnLCd0JywndScsJ3YnLCd3JywneCcsJ3knLCd6JywnQScsJ0InLCdDJywnRCcsJ0UnLCdGJywnRycsJ0gnLCdJJywnSicsJ0snLCdMJywnTScsJ04nLCdPJywnUCcsJ1EnLCdSJywnUycsJ1QnLCdVJywnVicsJ1cnLCdYJywnWScsJ1onXQogICAgbGV0IG51bWJlciA9IFsnMScsJzInLCczJywnNCcsJzUnLCc2JywnNycsJzgnLCc5JywnMCddCiAgICBsZXQgcHdkID0gJycKICAgIGxldCBtID0gc2V0SW50ZXJ2YWwoKCkgPT4gewogICAgaWYgKHB3ZC5sZW5ndGggIT09IDEwKSB7CiAgICBsZXQgY2hvaWNlID0gWydudW0nLCdsZXR0ZXInXQogICAgY2hvaWNlID0gY2hvaWNlW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGNob2ljZS5sZW5ndGgpXQogICAgaWYgKGNob2ljZSA9PT0gJ251bScpIHsKICAgIHB3ZCArPSBTdHJpbmcobnVtYmVyW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIG51bWJlci5sZW5ndGgpXSkKICAgIH0gZWxzZSB7CiAgICBwd2QgKz0gU3RyaW5nKGFscGhhYmV0W01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIGFscGhhYmV0Lmxlbmd0aCldKQogICAgfQogICAgfQogICAgfSwgMCk7CiAgICBpZiAoYmxhY2tMaXN0ZWQuaW5jbHVkZXMocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0pKSB7CiAgICByZXMuZW5kKGAKICAgIDxzdHlsZT4KYm9keSB7CmZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOwpiYWNrZ3JvdW5kLWNvbG9yOiAjYmFlYmY3Owp0cmFuc2l0aW9uOiAuM3M7Cn0KLmJ1dHRvbi1hY3Rpb25zIHsKICB0cmFuc2l0aW9uOiAuM3M7CiAgYm9yZGVyLXJhZGl1czogNHB4OwogIGJvcmRlcjogbm9uZTsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjMjU2M0VCOwogIGNvbG9yOiB3aGl0ZTsKICBmb250LXNpemU6IDE1cHg7CiAgaGVpZ2h0OiAyM3B4OwogIH0KICAuYnV0dG9uLWFjdGlvbnM6aG92ZXIgewogIGJhY2tncm91bmQtY29sb3I6ICMzQjgyRjY7CiAgY3Vyc29yOiBwb2ludGVyOwogIH0KLmJ1dHRvbi1hY3Rpb25zOmFjdGl2ZSB7CiAgYmFja2dyb3VuZC1jb2xvcjogIzAwNjZDQzsKICB9CiAgLmJ1dHRvbi1hY3Rpb25zOmRpc2FibGVkIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiBncmV5OwogIGN1cnNvcjogbm90LWFsbG93ZWQ7CiAgfQo8L3N0eWxlPgo8Y2VudGVyPgo8aDE+QmFuIGFwcGVhbHMgZm9yIGNoYXQtbG9sLmdsaXRjaC5tZTwvaDE+CjxoMz5QbGVhc2UgZG8gbm90IHVzZSBlbW9qaXMgaW4gYW55IG9mIHRoZSBnaXZlbiBpbnB1dHMgYmVsb3cuPC9oMz4KPGgyPldoeSB3ZXJlIHlvdSBiYW5uZWQ/PC9oMj4KPHRleHRhcmVhIHBsYWNlaG9sZGVyPSJUeXBlIGhlcmUuLi4iIHN0eWxlPSJ3aWR0aDogNDkxcHg7IGhlaWdodDogMTQ3cHg7IGZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOyIgbWF4bGVuZ3RoPSIyMDAiIGlkPSJhIj48L3RleHRhcmVhPgo8aDI+V2h5IGRvIHlvdSB0aGluayB5b3Ugc2hvdWxkIGJlIHVuYmFubmVkPyAoMjAwIENoYXJhY3RlciBsaW1pdCk8L2gyPgo8dGV4dGFyZWEgcGxhY2Vob2xkZXI9IlR5cGUgaGVyZS4uLiIgc3R5bGU9IndpZHRoOiA0NjBweDsgaGVpZ2h0OiAxMTdweDsgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7IiBtYXhsZW5ndGg9IjIwMCIgaWQ9ImIiPjwvdGV4dGFyZWE+PGJyPjxicj4KPHNwYW4gc3R5bGU9InBvc2l0aW9uOiBmaXhlZDsgdHJhbnNmb3JtOiBzY2FsZSgxLjUpOyBsZWZ0OiA2MDBweDsiPjxjZW50ZXI+PGJ1dHRvbiBjbGFzcz0iYnV0dG9uLWFjdGlvbnMiIGlkPSJzdWJtaXQiPlN1Ym1pdDwvYnV0dG9uPjwvY2VudGVyPjwvc3Bhbj4KPC9jZW50ZXI+CjxzY3JpcHQ+CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzdWJtaXQnKS5vbmNsaWNrID0gKCkgPT4gewpmZXRjaCgnaHR0cHM6Ly9jaGF0LWxvbC5nbGl0Y2gubWUvYmFuLWFwcGVhbHMnLCB7Cm1ldGhvZDogJ1BPU1QnLApoZWFkZXJzOiB7CidyZWFzb24nOiBTdHJpbmcoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS52YWx1ZSksCid3aHknOiBTdHJpbmcoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2InKS52YWx1ZSksCn0KfSkKZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgPSBcYAo8Y2VudGVyPgo8aDE+VGhhbmtzITwvaDE+CjxoMj5Zb3VyIGJhbiBhcHBlYWwgaGFzIGJlZW4gc3VibWl0dGVkLjxicj48c21hbGw+UGxlYXNlIGRvIG5vdCBlbnRlciBhbnkgc2Vuc2l0aXZlIGluZm9ybWF0aW9uLjwvaDI+CjwvY2VudGVyPgpcYAp9Cjwvc2NyaXB0PgogICAgYCkKICAgIH0gZWxzZSB7CiAgICByZXMuZW5kKGAKICAgIDwhRE9DVFlQRSBodG1sPgogICAgPHN0eWxlPgogICAgYm9keSB7IAogICAgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7CiAgICB0cmFuc2l0aW9uOiAuNHM7CiAgICB9CiAgICA8L3N0eWxlPgogICAgPGNlbnRlcj4KICAgIDxzdHlsZT4KICAgIGJvZHkgeyAKICAgIGZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOwogICAgdHJhbnNpdGlvbjogLjRzOwogICAgfQogICAgPC9zdHlsZT4KICAgIDx0aXRsZT5Xb2FoLCBob3BlIHRvIG5ldmVyIHNlZSB0aGlzIHBhZ2UuLjwvdGl0bGU+CiAgICA8Y2VudGVyPgogICAgPGgyPldvYWgsIGhvcGUgdG8gbmV2ZXIgc2VlIHRoaXMgcGFnZS48L2gyPgogICAgPHA+TG9va3MgbGlrZSB5b3UndmUgY29tZSB0byBhIHdyb25nIGRpcmVjdGlvbi4gWW91IGFyZW4ndCB3aGF0IHlvdSB0aGluay4gVGhlcmUgaXMgYSB3YXkgdG8gdHVybiBhcm91bmQgYW5kIGdvIGJhY2sgdG8gd2hlcmUgeW91IHdlcmUuLjwvcD4KICAgIDxwPjxhIGhyZWY9Imh0dHBzOi8vY2hhdC1sb2wuZ2xpdGNoLm1lIj5HbyBiYWNrITwvYT48L3A+CiAgICA8L2NlbnRlcj4KICAgIDwvY2VudGVyPgogICAgPHNjcmlwdD4KICAgIGRvY3VtZW50LmJvZHkuc3R5bGVbJ2JhY2tncm91bmQtY29sb3InXSA9ICIjYmFlYmY3IjsKICAgIHNldEludGVydmFsKCgpID0+IHsKICAgIGlmIChkb2N1bWVudC5ib2R5LnN0eWxlWydiYWNrZ3JvdW5kLWNvbG9yJ10gPT09ICIjYmFlYmY3IiB8fCBkb2N1bWVudC5ib2R5LnN0eWxlWydiYWNrZ3JvdW5kLWNvbG9yJ10gPT09ICJyZ2IoMTg2LCAyMzUsIDI0NykiKSB7CiAgICBkb2N1bWVudC5ib2R5LnN0eWxlWydiYWNrZ3JvdW5kLWNvbG9yJ10gPSAiI2Y3YmFiYSIKICAgIH0gZWxzZSBpZiAoZG9jdW1lbnQuYm9keS5zdHlsZVsnYmFja2dyb3VuZC1jb2xvciddID09PSAiI2Y3YmFiYSIgfHwgZG9jdW1lbnQuYm9keS5zdHlsZVsnYmFja2dyb3VuZC1jb2xvciddID09PSAicmdiKDI0NywgMTg2LCAxODYpIikgewogICAgZG9jdW1lbnQuYm9keS5zdHlsZVsnYmFja2dyb3VuZC1jb2xvciddID0gIiNiYWViZjciCiAgICB9CiAgICB9LCAxMDAwKTsKICAgIDwvc2NyaXB0PgogICAgYCkKICAgIH0KICAgIH0gZWxzZSB7CiAgICBjb25zb2xlLmxvZyhyZXEudXJsKTsKICAgIHJlcXVlc3RzLnB1c2gocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0pOwogICAgcmVzLndyaXRlSGVhZCgyMDApOwogICAgcmVzLmVuZChgCiAgICA8IURPQ1RZUEUgaHRtbD4KICAgIDxodG1sPgogICAgPGhlYWQ+CiAgICA8c3R5bGU+CiAgICBib2R5IHsKICAgIGZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOwogICAgb3ZlcmZsb3ctd3JhcDogYnJlYWstd29yZDsKICAgIH0KICAgICNhIHsKICAgIG92ZXJmbG93OiBub25lOwogICAgfQogICAgI2NvbnRyb2xzIHsKICAgIHBvc2l0aW9uOiBmaXhlZDsKICAgIHRvcDogNTczcHg7CiAgICB9CiAgICBAa2V5ZnJhbWVzIHJhaW5ib3cgewogICAgMCUgeyBjb2xvcjogcmVkOyB9CiAgICAxNCUgeyBjb2xvcjogb3JhbmdlOyB9CiAgICAyOCUgeyBjb2xvcjogeWVsbG93OyB9CiAgICA0MiUgeyBjb2xvcjogZ3JlZW47IH0KICAgIDU3JSB7IGNvbG9yOiBsaWdodGdyZWVuOyB9CiAgICA3MSUgeyBjb2xvcjogYmx1ZTsgfQogICAgODUlIHsgY29sb3I6IGxpZ2h0Ymx1ZTsgfQogICAgOTQlIHsgY29sb3I6IHZpb2xldDsgfQogICAgMTAwJSB7IGNvbG9yOiByZWQ7IH0KICAgIH0KCiAgICAucmFpbmJvdy10ZXh0IHsKICAgIGFuaW1hdGlvbjogcmFpbmJvdyAzcyBsaW5lYXIgaW5maW5pdGU7CiAgICB9CiAgICBAa2V5ZnJhbWVzIGJsdWUgewogICAgMCUgeyBjb2xvcjogbGlnaHRibHVlOyB9CiAgICAyNSUgeyBjb2xvcjogYmx1ZTsgfQogICAgNTAlIHsgY29sb3I6IGxpZ2h0Ymx1ZTsgfQogICAgNzUlIHsgY29sb3I6IGJsdWU7IH0KICAgIDEwMCUgeyBjb2xvcjogbGlnaHRibHVlOyB9CiAgICB9CiAgICAuYmx1ZS10ZXh0IHsKICAgIGFuaW1hdGlvbjogYmx1ZSAzcyBsaW5lYXIgaW5maW5pdGU7CiAgICB9CiAgICAuYnV0dG9uLWFjdGlvbnMgewogIHRyYW5zaXRpb246IC4zczsKICBib3JkZXItcmFkaXVzOiA0cHg7CiAgYm9yZGVyOiBub25lOwogIGJhY2tncm91bmQtY29sb3I6ICMyNTYzRUI7CiAgY29sb3I6IHdoaXRlOwogIGZvbnQtc2l6ZTogMTVweDsKICBoZWlnaHQ6IDIzcHg7CiAgfQogIC5idXR0b24tYWN0aW9uczpob3ZlciB7CiAgYmFja2dyb3VuZC1jb2xvcjogIzNCODJGNjsKICBjdXJzb3I6IHBvaW50ZXI7CiAgfQouYnV0dG9uLWFjdGlvbnM6YWN0aXZlIHsKICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA2NkNDOwogIH0KICAuYnV0dG9uLWFjdGlvbnM6ZGlzYWJsZWQgewogIGJhY2tncm91bmQtY29sb3I6IGdyZXk7CiAgY3Vyc29yOiBub3QtYWxsb3dlZDsKICB9CiAgICA8L3N0eWxlPgogICAgPC9oZWFkPgogICAgPGJvZHk+CiAgICA8ZGl2IGlkPSJkZWJ1ZyIgc3R5bGU9InRyYW5zaXRpb246IC4zczsgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7IiBoaWRkZW4+CjxkaXYgc3R5bGU9InBvc2l0aW9uOiBmaXhlZDsgd2lkdGg6IDEwMCU7IGhlaWdodDogMTAwJTsgb3BhY2l0eTogMC4yOyB6LWluZGV4OiA0OyBiYWNrZ3JvdW5kLWNvbG9yOiBibGFjazsiPjwvZGl2Pgo8ZGl2IHN0eWxlPSJwb3NpdGlvbjogZml4ZWQ7IHotaW5kZXg6IDQ7IGJhY2tncm91bmQtY29sb3I6IHdoaXRlOyB0b3A6IDUwJTsgbGVmdDogNTAlOyB3aWR0aDogNjAlOyBoZWlnaHQ6IGF1dG87IGJvcmRlci1yYWRpdXM6IDlweDsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSk7Ij4KPHNlY3Rpb24gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNGMjc3Mjc7IGJvcmRlci1yYWRpdXM6IDVweDsgaGVpZ2h0OiAzNXB4OyI+PGI+PGNlbnRlcj48Zm9udCBzaXplPSI1Ij5EZWJ1ZyAoTW9kZSAxKTwvZm9udD48L2NlbnRlcj48L2I+PC9zZWN0aW9uPjxicj4KPGNlbnRlcj4KQ2hlY2tzIGhvdyBhY3RpdmUgdGhlIGNoYXQgaXMuPGJyPjxicj4KPGI+PHNwYW4gaWQ9Im1wcyI+KExvYWRpbmcuLi4pPC9zcGFuPjwvYj4gbWVzc2FnZXMgcGVyIDMwc2VjPGJyPjxicj4KRG8gbm90IGNsb3NlIHRoaXMgd2luZG93IGJlZm9yZSB0aGUgbWVzc2FnZXMgbG9hZC4KPC9jZW50ZXI+PGJyPgo8c2VjdGlvbj48Y2VudGVyPjxidXR0b24gaWQ9ImQxLWNsb3NlIiBjbGFzcz0iYnV0dG9uLWFjdGlvbnMiPjxiPkNsb3NlPC9iPjwvYnV0dG9uPjwvY2VudGVyPjwvc2VjdGlvbj48YnI+CjwvZGl2Pgo8L2Rpdj4KICAgIDxkaXYgaWQ9InNldHRpbmdzIiBzdHlsZT0idHJhbnNpdGlvbjogLjNzOyBmb250LWZhbWlseTogc2Fucy1zZXJpZjsiIGhpZGRlbj4KPGRpdiBzdHlsZT0icG9zaXRpb246IGZpeGVkOyB3aWR0aDogMTAwJTsgaGVpZ2h0OiAxMDAlOyBvcGFjaXR5OiAwLjI7IHotaW5kZXg6IDQ7IGJhY2tncm91bmQtY29sb3I6IGJsYWNrOyI+PC9kaXY+CjxkaXYgc3R5bGU9InBvc2l0aW9uOiBmaXhlZDsgei1pbmRleDogNDsgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7IHRvcDogNTAlOyBsZWZ0OiA1MCU7IHdpZHRoOiA2MCU7IGhlaWdodDogYXV0bzsgYm9yZGVyLXJhZGl1czogOXB4OyB0cmFuc2Zvcm06IHRyYW5zbGF0ZSgtNTAlLCAtNTAlKTsiPgo8c2VjdGlvbiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogI0YyNzcyNzsgYm9yZGVyLXJhZGl1czogNXB4OyBoZWlnaHQ6IDM1cHg7Ij48Yj48Y2VudGVyPjxmb250IHNpemU9IjUiPkNoYXQgUm9vbSBSdWxlczwvZm9udD48L2NlbnRlcj48L2I+PC9zZWN0aW9uPgo8ZGl2PjxzZWN0aW9uPjxjZW50ZXI+PGJyPgoKPGI+PGJpZz5SdWxlICMxPC9iaWc+PC9iPjxicj4KRG8gbm90IGFkdmVydGlzZS4gQWR2ZXJ0aXNpbmcgaXMgc3RyaWN0bHkgTk9UIGFsbG93ZWQgaGVyZS4gUGVvcGxlIGFyZSBub3QgaGVyZSAgdG8gYmUgYWR2ZXJ0aXNlZCB0by48YnI+PGJyPgo8Yj48YmlnPlJ1bGUgIzI8L2JpZz48L2I+PGJyPgpEbyBub3Qgc3BhbS4gU3BhbW1pbmcgY2FuIHJlc3VsdCBpbiBhIGF1dG9tYXRpYyBtdXRlLiBIb3dldmVyLCBpZiBzb21lb25lIGdvZXMgdW5ub3RpY2VkLCB0aGU8YnI+ZGV2IGNhbiBzdGlsbCBtdXRlIHlvdS48YnI+PGJyPgo8Yj48YmlnPlJ1bGUgIzM8L2JpZz48L2I+PGJyPgpEbyBub3Qgc2F5IHNsdXJzLiBTbHVycyBjYW4gb2ZmZW5kIHBlb3BsZSwgYW5kIGl0IGNhbiByZXN1bHQgeW91IGluIGdldHRpbmcgYSBtdXRlLjxicj48YnI+CjxiPjxiaWc+UnVsZSAjNDwvYmlnPjwvYj48YnI+CkRvIG5vdCBtYWtlIHRvbyBtYW55IGFsdHMuIE1ha2luZyB0b28gbWFueSBhbHRzIGNhbiBsYWcgeW91ciBzZXJ2ZXIsIGFsc28gcmVzdWx0aW5nIGluIGEgbXV0ZS48YnI+PGJyPgoKPGI+PGJpZz5SdWxlICM1PC9iaWc+PC9iPjxicj4KVGhlIGRldmVsb3BlciAoPHNwYW4gY2xhc3M9InJhaW5ib3ctdGV4dCI+PGI+bG9sOTk5OTI8L2I+PC9zcGFuPikgaXMgYWxsb3dlZCB0byBnaXZlIG91dCBwdW5pc2htZW50cyB0byBvbmVzIDxpPndobyB0cnkgdG8gZmluZCBsb29waG9sZXM8YnI+b3Igc3R1ZmYgdG8gd29ya2Fyb3VuZCB0aGUgcnVsZXM8L2k+LCB3aGljaCBhbHNvIG5vdCBhbGxvd2VkLiBJZiB5b3UgdGhpbmsgeW91J3ZlIGJlZW4gdHJlYXRlZCB1bmZhaXJseSwgcGxlYXNlIGFwcGVhbCB0byA8c3BhbiBjbGFzcz0icmFpbmJvdy10ZXh0Ij48Yj5sb2w5OTk5MjwvYj48L3NwYW4+Lgo8YnI+CjxzbWFsbD48c21hbGw+SWYgeW91IHNlZSBhbnlvbmUgYnJlYWtpbmcgdGhlIHJ1bGVzICYgbWFraW5nIHBlb3BsZSBhbmdyeSBpbiBvdGhlciBjaGF0cy9tYWluIGNoYXQsIGRvbid0IGFyZ3VlLCBlbmZsYW1lLCBvciBlbmdhZ2UgaW4gdGhlIGFyZ3VlbWVudC9maWdodCwgd2hpY2ggY291bGQ8YnI+IGdldCB5b3UgaW4gdHJvdWJsZSBhcyB3ZWxsLiBQbGVhc2UgL3JlcG9ydCAodGhlaXIgbmFtZSkgaW5zdGVhZC4gSWYgaXQgaXMgYW5vdGhlciBWaXJ0dWFsQ2hhdCwgcGxlYXNlIHVzZSAvcmNoYXQgKGNoYXRuYW1lKS48L3NtYWxsPjwvc21hbGw+Cjxicj48YnI+CjwvY2VudGVyPjwvc2VjdGlvbj48L2Rpdj4KPHNlY3Rpb24+PGNlbnRlcj48YnV0dG9uIGlkPSJzZXR0aW5ncy1jbG9zZSIgY2xhc3M9ImJ1dHRvbi1hY3Rpb25zIj48Yj5DbG9zZTwvYj48L2J1dHRvbj48L2NlbnRlcj48L3NlY3Rpb24+PGJyPgo8L2Rpdj4KPC9kaXY+CjxkaXYgaWQ9InJlY29ubmVjdGluZyIgaGlkZGVuPgo8ZGl2IHN0eWxlPSJwb3NpdGlvbjogZml4ZWQ7IHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpIHNjYWxlKDIpOyB0b3A6IDUwJTsgbGVmdDogNTAlOyBiYWNrZ3JvdW5kLWNvbG9yOiBncmV5OyB3aWR0aDogNTAlOyBoZWlnaHQ6IDUwJTsgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7IG9wYWNpdHk6IC4zOyB6LWluZGV4OiA1OyI+PC9kaXY+CjxkaXYgc3R5bGU9InBvc2l0aW9uOiBmaXhlZDsgdHJhbnNmb3JtOiB0cmFuc2xhdGUoLTUwJSwgLTUwJSkgc2NhbGUoMS41KTsgdG9wOiA1MCU7IGxlZnQ6IDUwJTsgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7IHotaW5kZXg6IDY7Ij4KPGJpZz48YmlnPjxiPlJlY29ubmVjdGluZy4uLjwvYj48L2JpZz48YnI+PHNtYWxsPjxzbWFsbD5IYXZpbmcgdHJvdWJsZXMgY29ubmVjdGluZyB0byB0aGUgc2VydmVyPzxicj5DaGVjayBpZiB5b3UgYXJlIGNvbm5lY3RlZCB0byB0aGUgaW50ZXJuZXQhPGJyPlR1cm4gb2ZmIGFpcnBsYWluZSBtb2RlITxicj5SZXN0YXJ0IHlvdXIgY29tcHV0ZXIhPGJyPkNoZWNrIHlvdXIgd2lmaSByb3V0ZXIsIG9yIHJlc3RhcnQgaXQhPGJyPjxzbWFsbD48cD5TdGlsbCBubyBpc3N1ZXMgZm91bmQ/IFRoZXJlIGNvdWxkIGJlIGEgcHJvYmxlbSB3aXRoIHRoZSBzZXJ2ZXIsIG9yIHlvdSBtaWdodCBiZSB1c2luZyBhIFZQTi48L3A+PC9zbWFsbD48L3NtYWxsPjwvc21hbGw+PC9iaWc+CjwvZGl2Pgo8L2Rpdj4KICAgIDxoMT5DaGF0IFJvb208L2gxPgogICAgPGRpdiBzdHlsZT0iaGVpZ2h0OiAxMDBweDsgb3ZlcmZsb3c6IG5vbmU7Ij4KICAgIDxkaXYgaWQ9ImEiPjxmb250IGNvbG9yPSJncmV5IiBzaXplPSI0Ij48YmlnPkNvbm5lY3RpbmcuLi48L2JpZz48L2ZvbnQ+PC9kaXY+PGJyPgogICAgPGlucHV0IGlkPSJuYW1lIiBwbGFjZWhvbGRlcj0iTmFtZSIgZGlzYWJsZWQ+IDxpbnB1dCBpZD0ibXNnIiBwbGFjZWhvbGRlcj0iTWVzc2FnZSIgZGlzYWJsZWQ+PGJ1dHRvbiBpZD0ic2VuZCIgZGlzYWJsZWQ+U2VuZDwvYnV0dG9uPjxicj48YnI+CiAgICA8c3BhbiBpZD0idHlwaW5nRGl2IiBzdHlsZT0ib3BhY2l0eTogMDsgdHJhbnNpdGlvbjogLjNzOyIgaGlkZGVuPgogICAgPGI+PHNwYW4gaWQ9InR5cGluZyI+PC9zcGFuPjwvYj4KICAgIDwvc3Bhbj4KICAgIDwvZGl2PgogICAgPHNjcmlwdD4KICAgIHdpbmRvdy5vbmVycm9yID0gKGVycm9yKSA9PiB7CiAgICBhbGVydCgnQW4gZXJyb3IgaGFzIG9jY3VyZWQuIFRoZSB3ZWJzaXRlIG1pZ2h0IG5vdCB3b3JrLCBvciB0aGVyZSBjb3VsZCBiZSB1bmV4cGVjdGVkIGJlaGF2aW91ci4gRXJyb3I6ICcrZXJyb3IpCiAgICB9CiAgICBpZiAoIXdpbmRvdy5sb2NhbFN0b3JhZ2UubXNncykgewogICAgd2luZG93LmxvY2FsU3RvcmFnZS5tc2dzID0ge2U6IFtdfTsKICAgIH0KICAgICR7IXByb2Nlc3MuZW52LklQLnNwbGl0KCcsJykuaW5jbHVkZXMocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0pID8gYGlmICh0cnVlKSB7IC8vIE5vdyBub2JvZHkgY2FuIG1vZGlmeSBhbnkgZGVmaW5lZCB2YXJpYWJsZXMgaW4gaGVyZSBjdXogdGhleSBhcmVuJ3QgZ2xvYmFsIDopIChlLmcgbXV0ZSB2YXJpYWJsZSB0byB1bm11dGUpYCA6IGBgfQogICAgbGV0IHNldGludGVydmFsCiAgICBzZXRpbnRlcnZhbCA9IHNldEludGVydmFsOwogICAgc2V0SW50ZXJ2YWwgPSAoKSA9PiB7CiAgICByZXR1cm4gIm5haCBicm8gd2h5J2QgeW91IHdhbm5hIHJ1biB0aGlzPyIKICAgIH0KICAgIGxldCB3ZWJzb2NrZXQKICAgIHdlYnNvY2tldCA9IFdlYlNvY2tldDsKICAgIFdlYlNvY2tldCA9ICgpID0+IHsKICAgIHJldHVybiAic2h1dCB1cCwgbm8gd2Vic29ja2V0IGZvciB5b3UiCiAgICB9CiAgICBsZXQgdmlydXMgPSBmYWxzZTsKICAgIGxldCB2aXJ1c25ldyA9IGZhbHNlOwogICAgbGV0IHByZXNzID0gZmFsc2U7CiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCAoZXZlbnQpID0+IHsKcHJlc3MgPSB0cnVlOwp9KQpkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgKGV2ZW50KSA9PiB7CnByZXNzID0gZmFsc2U7Cn0pCmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNlbW92ZScsIChldmVudCkgPT4gewppZiAodmlydXMgPT09IHRydWUpIHsKbGV0IHNwYW4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CnNwYW4uaW5uZXJIVE1MID0gJzxzcGFuIHN0eWxlPSJwb3NpdGlvbjogZml4ZWQ7IGxlZnQ6ICcrZXZlbnQuY2xpZW50WCsncHg7IHRvcDogJytldmVudC5jbGllbnRZKydweDsgdXNlci1zZWxlY3Q6IG5vbmU7IiB1c2VyLXNlbGVjdD0ibm9uZSI+VklSVVM8L3NwYW4+Jwpkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHNwYW4pCmlmICh2aXJ1c25ldyA9PT0gdHJ1ZSkgewpzZXRUaW1lb3V0KCgpID0+IHsKZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChzcGFuKTsKfSwgNTAwKTsKfQp9Cn0pCiAke3Byb2Nlc3MuZW52LklQLnNwbGl0KCcsJykuaW5jbHVkZXMocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0pID8gYC8qc2V0aW50ZXJ2YWwoKCkgPT4gewogICAgY29uc29sZS5jbGVhcigpOyAvLyBEdWUgdG8gcmVzdHJpY3Rpb25zLCBkbyBub3QgbGV0IG5vcm1hbCBwZW9wbGUgdXNlIGNvbnNvbGUKICAgIGNvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7Y29uc29sZS5jbGVhcigpO2NvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7Y29uc29sZS5jbGVhcigpO2NvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7Y29uc29sZS5jbGVhcigpO2NvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7CiAgICB9ICwwKTsqL2AgOiBgc2V0aW50ZXJ2YWwoKCkgPT4gewogICAgY29uc29sZS5jbGVhcigpOyAvLyBEdWUgdG8gcmVzdHJpY3Rpb25zLCBkbyBub3QgbGV0IG5vcm1hbCBwZW9wbGUgdXNlIGNvbnNvbGUKICAgIGNvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7Y29uc29sZS5jbGVhcigpO2NvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7Y29uc29sZS5jbGVhcigpO2NvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7Y29uc29sZS5jbGVhcigpO2NvbnNvbGUuY2xlYXIoKTtjb25zb2xlLmNsZWFyKCk7CiAgICB9ICwwKTtgfQogICAgbGV0IHJlZnJlc2gKICAgIHJlZnJlc2ggPSB3aW5kb3cubG9jYXRpb24ucmVsb2FkOwogICAgbGV0IHR5cGluZyA9IFtdOwogICAgbGV0IGlzVHlwaW5nID0gZmFsc2U7CiAgICBsZXQgc2VudFR5cGluZyA9IGZhbHNlOwogICAgc2V0aW50ZXJ2YWwoKCkgPT4gewogICAgaWYgKHR5cGluZy5sZW5ndGggPiAwKSB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHlwaW5nJykuaW5uZXJUZXh0ID0gdHlwaW5nLmpvaW4oJywgJykrXGAgXCRce3R5cGluZy5sZW5ndGggPiAxID8gJ2FyZScgOiAnaXMnfSB0eXBpbmcuLi5cYAogICAgfSBlbHNlIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0eXBpbmcnKS5pbm5lclRleHQgPSAnTm8gb25lIGlzIHR5cGluZy4nCiAgICB9CiAgICB9LCAwKTsKICAgIHNldGludGVydmFsKCgpID0+IHsKICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykudmFsdWUubGVuZ3RoID4gMCkgewogICAgaXNUeXBpbmcgPSB0cnVlOwogICAgfSBlbHNlIHsKICAgIGlzVHlwaW5nID0gZmFsc2U7CiAgICB9CiAgICB9LCA1MDApOwogICAgZnVuY3Rpb24gYWRkVHlwaW5nSW5kaWNhdG9yKG5hbWUpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0eXBpbmdEaXYnKS5oaWRkZW4gPSBmYWxzZTsKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3R5cGluZ0RpdicpLnN0eWxlLm9wYWNpdHkgPSAxOwogICAgfSwgMzAwKTsKICAgIHR5cGluZy5wdXNoKG5hbWUpOwogICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBmdW5jdGlvbiByZW1vdmVUeXBpbmdJbmRpY2F0b3IobmFtZSkgewogICAgdHlwaW5nLnNwbGljZSh0eXBpbmcuaW5kZXhPZihuYW1lKSwgMSk7CiAgICBpZiAodHlwaW5nLmxlbmd0aCA9PT0gMCkgeyAKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0eXBpbmdEaXYnKS5zdHlsZS5vcGFjaXR5ID0gMDsKICAgIC8qc2V0VGltZW91dCgoKSA9PiB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndHlwaW5nRGl2JykuaGlkZGVuID0gdHJ1ZTsKICAgIH0sIDQwMCk7Ki8KICAgIH0KICAgIHJldHVybiB0cnVlOwogICAgfQogICAgbGV0IGNoZWNrZWROYW1lID0gZmFsc2U7CiAgICBzZXRpbnRlcnZhbCgoKSA9PiB7CiAgICBsZXQgc2x1cnMgPSBbJ25pZ2dhJywgJ25pZ2dlcicsICduaWdnZScsICduaWdnJywgJ05JR0cnLCAnTmlnZ2EnLCAnTmlnZ2VyJywgJ05pZ2dlJywgJ05pZ2cnLCAnVW5jbGUgVG9tJywgJ1VuY2xlIFQnLCAnVW5jbGUgdG9tJywgJ3VuY2xlIHRvbScsICd1bmNsZSBUb20nLCAnU2x1dCcsICdzbHV0JywgJ3NMdXQnLCAnc2xVdCcsICdzbHVUJywgJ3NMVVQnLCAnVU5DTEUgVE9NJywgJ05JR0dBJywgJ1NMVVQnLCAnTklHR0VSJ10KICAgIGZvciAobGV0IHNsdXIgb2Ygc2x1cnMpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpO2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoc2x1ciwgJycpOwogICAgfQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUucmVwbGFjZUFsbCgnQGV2ZXJ5b25lJywgJyhhdClldmVyeW9uZScpCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZS5yZXBsYWNlQWxsKCdAZXZlcnlvbmUnLCAnKGF0KWV2ZXJ5b25lJykKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoJ0BldmVyeW9uZScsICcoYXQpZXZlcnlvbmUnKQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUucmVwbGFjZUFsbCgnQGV2ZXJ5b25lJywgJyhhdClldmVyeW9uZScpCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZS5yZXBsYWNlQWxsKCdAZXZlcnlvbmUnLCAnKGF0KWV2ZXJ5b25lJykKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlLnJlcGxhY2VBbGwoJ0BldmVyeW9uZScsICcoYXQpZXZlcnlvbmUnKQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUucmVwbGFjZUFsbCgnQGV2ZXJ5b25lJywgJyhhdClldmVyeW9uZScpCiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZS5pbmNsdWRlcygnQGV2ZXJ5b25lJykpIHsKICAgIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTsKICAgIH0KICAgIH0sIDApOwogICAgbGV0IGRpc2Nvbm5lY3RlZCA9IDA7CiAgICBsZXQgbXV0ZSA9IGZhbHNlOwogICAgbGV0IGJhbm5lZCA9IGZhbHNlOwogICAgbGV0IGggPSBmYWxzZTsKICAgIGxldCBkMSA9IGZhbHNlOwogICAgbGV0IG1wcyA9IDA7CiAgICBzZXRpbnRlcnZhbCgoKSA9PiB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXBzJykuaW5uZXJUZXh0ID0gbXBzOwogICAgfSwgMCk7CiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIGZ1bmN0aW9uKGV2ZW50KSB7IC8vIEtleWRvd24gZXZlbnRzCiAgICBpZiAoZXZlbnQua2V5ID09PSAnRXNjYXBlJyB8fCBldmVudC5rZXkgPT09ICdFc2MnIHx8IGV2ZW50LmtleSA9PT0gJ0VTQycgfHwgZXZlbnQua2V5ID09PSAnRVNDQVBFJyB8fCBldmVudC5rZXkgPT09ICdlc2NhcGUnIHx8IGV2ZW50LmtleSA9PT0gJ2VzYycpIHsKICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3MnKS5oaWRkZW4gPT09IHRydWUpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5ncycpLmhpZGRlbiA9IGZhbHNlOwogICAgfSBlbHNlIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5ncycpLmhpZGRlbiA9IHRydWU7CiAgICB9CiAgICB9CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2V0dGluZ3MtY2xvc2UnKS5vbmNsaWNrID0gKCkgPT4gewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzLWNsb3NlJykuZGlzYWJsZWQgPSB0cnVlOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NldHRpbmdzJykuaGlkZGVuID0gdHJ1ZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZXR0aW5ncy1jbG9zZScpLmRpc2FibGVkID0gZmFsc2U7CiAgICB9CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZDEtY2xvc2UnKS5vbmNsaWNrID0gKCkgPT4gewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2QxLWNsb3NlJykuZGlzYWJsZWQgPSB0cnVlOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2RlYnVnJykuaGlkZGVuID0gdHJ1ZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdkMS1jbG9zZScpLmRpc2FibGVkID0gZmFsc2U7CiAgICB9CiAgICBpZiAoZXZlbnQua2V5ID09PSAnRW50ZXInICYmIGggPT09IHRydWUpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdzZW5kJykuY2xpY2soKQogICAgfSBlbHNlIGlmIChldmVudC5rZXkgPT09ICdFbnRlcicgJiYgaCA9PT0gZmFsc2UpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS5mb2N1cygpCiAgICB9CiAgICBpZiAoKGV2ZW50LmtleSA9PT0gIjEiIHx8IGV2ZW50LmtleSA9PT0gIm9uZSIpICYmIGggPT09IGZhbHNlKSB7CiAgICBkMSA9IHRydWU7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIGlmIChkMSA9PT0gdHJ1ZSkgewogICAgCiAgICB9CiAgICB9LCAzMDAwKTsKICAgIH0KICAgIH0pCiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCBmdW5jdGlvbihldmVudCkgeyAvLyBLZXl1cCBldmVudHMKICAgIGlmIChldmVudC5rZXkgPT09ICIxIiB8fCBldmVudC5rZXkgPT09ICJvbmUiKSB7CiAgICBkMSA9IGZhbHNlOwogICAgfQogICAgfSkKICAgIGxldCBtZXNzYWdlcwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLm9uZm9jdXMgPSAoKSA9PiB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLmRpc2FibGVkID0gdHJ1ZTsKICAgIGggPSB0cnVlOwogICAgaWYgKG5hbWVzZW50ID09PSBmYWxzZSkgewogICAgbmFtZXNlbnQgPSB0cnVlOwogICAgfQogICAgfQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLm9uYmx1ciA9ICgpID0+IHsKICAgIGggPSBmYWxzZTsKICAgIH0KICAgIGxldCBuYW1lc2VudCA9IGZhbHNlOwogICAgc2V0aW50ZXJ2YWwoKCkgPT4gewogICAgaWYgKGJhbm5lZCA9PT0gdHJ1ZSkgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLmRpc2FibGVkID0gdHJ1ZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS50aXRsZSA9ICdZb3UgaGF2ZSBiZWVuIGJhbm5lZC4nCiAgICB9IGVsc2UgaWYgKG11dGUgPT09IHRydWUpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS5kaXNhYmxlZCA9IHRydWU7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykudGl0bGUgPSAnWW91IGhhdmUgYmVlbiBtdXRlZC4nCiAgICB9IGVsc2UgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLmRpc2FibGVkID0gZmFsc2U7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykubWF4TGVuZ3RoID0gJzEwMCc7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykudGl0bGUgPSAnJwogICAgfQogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS5tYXhMZW5ndGggPSAnMTAwJwogICAgaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykudmFsdWUucmVwbGFjZUFsbCgnICcsICcnKS5sZW5ndGggPiAwICYmIG11dGUgPT09IGZhbHNlICYmIGJhbm5lZCA9PT0gZmFsc2UpIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS5kaXNhYmxlZCA9IGZhbHNlOwogICAgfSBlbHNlIHsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS5kaXNhYmxlZCA9IHRydWUKICAgIH0KICAgIGlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykudmFsdWUucmVwbGFjZUFsbCgnICcsICcnKS5sZW5ndGggPiAwICYmIG5hbWVzZW50ID09PSB0cnVlKSB7CiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2VuZCcpLmRpc2FibGVkID0gZmFsc2U7CiAgICB9IGVsc2UgewogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbmQnKS5kaXNhYmxlZCA9IHRydWU7CiAgICB9CiAgICB9LCAwKTsKICAgIGxldCBzID0gZnVuY3Rpb24gdChyZWNvbm5lY3QpIHsKICAgIGxldCBzb2NrZXQgPSBuZXcgd2Vic29ja2V0KCd3c3M6Ly9jaGF0LWxvbC5nbGl0Y2gubWUvJyk7CiAgICBzZXRpbnRlcnZhbCgoKSA9PiB7CiAgICBpZiAoaXNUeXBpbmcgPT09IHRydWUpIHsKICAgIGlmIChzZW50VHlwaW5nID09PSBmYWxzZSkgewogICAgLy9jb25zb2xlLmxvZygnU2VudCB0eXBpbmchJykKICAgIC8vc2VudFR5cGluZyA9IHRydWU7CiAgICAvL3NvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiAndHlwaW5nJ30pKTsKICAgIH0KICAgIH0gZWxzZSBpZiAoaXNUeXBpbmcgPT09IGZhbHNlKSB7CiAgICBpZiAoc2VudFR5cGluZyA9PT0gdHJ1ZSkgewogICAgLy9jb25zb2xlLmxvZygnUmVtb3ZlZCB0eXBpbmchJykKICAgIC8vc2VudFR5cGluZyA9IGZhbHNlOwogICAgLy9zb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3J0eXBpbmcnfSkpOwogICAgfQogICAgfQogICAgfSwwKTsKc29ja2V0Lm9ub3BlbiA9ICgpID0+IHsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlY29ubmVjdGluZycpLmhpZGRlbiA9IHRydWU7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykuZGlzYWJsZWQgPSBmYWxzZQppZiAocmVjb25uZWN0ID09PSBmYWxzZSkgewpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmlubmVySFRNTCA9ICR7ImAifTxmb250IGNvbG9yPSJncmV5IiBzaXplPSI0Ij48YmlnPk5vIG1lc3NhZ2VzITwvYmlnPjwvZm9udD48YnI+SXQgc2VlbXMgbGlrZSBubyBtZXNzYWdlcyBoYXZlIGJlZW4gcmVjaWV2ZWQgeWV0LCBvciB0aGVyZSBhcmVuJ3QgYW55LiBTYXkgaGkhJHsiYCJ9Cn0gZWxzZSBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgIT09ICR7ImAifTxmb250IGNvbG9yPSJncmV5IiBzaXplPSI0Ij48YmlnPk5vIG1lc3NhZ2VzITwvYmlnPjwvZm9udD48YnI+SXQgc2VlbXMgbGlrZSBubyBtZXNzYWdlcyBoYXZlIGJlZW4gcmVjaWV2ZWQgeWV0LCBvciB0aGVyZSBhcmVuJ3QgYW55LiBTYXkgaGkhJHsiYCJ9KSB7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuaW5uZXJIVE1MICs9ICc8aHI+PGNlbnRlcj48Yj5Zb3Ugd2VyZSByZWNvbm5lY3RlZDwvYj48L2NlbnRlcj48aHI+Jwp9CmxldCBjaGVja0lmVGhlTmFtZUlzRG9uZUxvbCA9IHNldGludGVydmFsKCgpID0+IHsKaWYgKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykuZGlzYWJsZWQgPT09IHRydWUpIHsKY2xlYXJJbnRlcnZhbChjaGVja0lmVGhlTmFtZUlzRG9uZUxvbCkKc29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdqb2luJywgdGV4dDogZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZX0pKTsKfQp9LCAwKTsKaWYgKHJlY29ubmVjdCA9PT0gdHJ1ZSkgewpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykuYmx1cigpCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS5mb2N1cygpOwovKmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCduYW1lJykuZGlzYWJsZWQgPSB0cnVlOwpzb2NrZXQuc2VuZChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ2pvaW4nLCB0ZXh0OiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlfSkpOyovCn0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3NlbmQnKS5vbmNsaWNrID0gKCkgPT4gewogICAgaWYgKGRpc2Nvbm5lY3RlZCA9PT0gMSB8fCBtdXRlID09PSB0cnVlIHx8IGJhbm5lZCA9PT0gdHJ1ZSB8fCBuYW1lc2VudCA9PT0gZmFsc2UgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLnZhbHVlLmluY2x1ZGVzKCdodHRwcycpIHx8IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS52YWx1ZS5pbmNsdWRlcygnaHR0cCcpIHx8IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS52YWx1ZS5pbmNsdWRlcygnZ2xpdGNoLm1lJykgfHwgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLnZhbHVlLmluY2x1ZGVzKCdnbGl0Y2ggbWUnKSkgewogICAgd2luZG93LnNjcm9sbFRvKHsKICAgIHRvcDogZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQrMTAwLAogICAgfSk7CiAgICBpZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgPT09ICR7ImAifTxmb250IGNvbG9yPSJncmV5IiBzaXplPSI0Ij48YmlnPk5vIG1lc3NhZ2VzITwvYmlnPjwvZm9udD48YnI+SXQgc2VlbXMgbGlrZSBubyBtZXNzYWdlcyBoYXZlIGJlZW4gcmVjaWV2ZWQgeWV0LCBvciB0aGVyZSBhcmVuJ3QgYW55LiBTYXkgaGkhJHsiYCJ9KSB7CmxldCBtc2cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7Cm1zZy5pbm5lckhUTUwgPSAkeyJgIn0keyIkeyJ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25hbWUnKS52YWx1ZX06IDxmb250IGNvbG9yPSJyZWQiPiR7IiR7In1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykudmFsdWV9PC9mb250PiR7ImAifTsKbXNnLmlubmVySFRNTCArPSAkeyJgIn0gPHNtYWxsPjxzbWFsbD48c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUb2RheSwgYXQgJHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDI0KX07IFRoaXMgbWVzc2FnZSB3YXMgbm90IHNlbnQuIj4keyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjEpfTwvc3Bhbj48L3NtYWxsPjwvc21hbGw+JHsiYCJ9CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuaW5uZXJIVE1MID0gJyc7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuYXBwZW5kQ2hpbGQobXNnKTsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLnZhbHVlID0gJycKfSBlbHNlIHsKbGV0IG1zZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKbXNnLmlubmVySFRNTCA9ICR7ImAifSR7IiR7In1kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmFtZScpLnZhbHVlfTogPGZvbnQgY29sb3I9InJlZCI+JHsiJHsifWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS52YWx1ZX08L2ZvbnQ+JHsiYCJ9Owptc2cuaW5uZXJIVE1MICs9ICR7ImAifSA8c21hbGw+PHNtYWxsPjxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRvZGF5LCBhdCAkeyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjQpfTsgVGhpcyBtZXNzYWdlIHdhcyBub3Qgc2VudC4iPiR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyMSl9PC9zcGFuPjwvc21hbGw+PC9zbWFsbD4keyJgIn0KZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgKz0gJzxicj4nOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmFwcGVuZENoaWxkKG1zZyk7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS52YWx1ZSA9ICcnCn0KICAgIH0gZWxzZSB7CiAgICBzb2NrZXQuc2VuZCgkeyJgIn0keyIkeyJ9ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLnZhbHVlLnJlcGxhY2VBbGwoXGAKXGAsICcnKX0keyJgIn0pCiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbXNnJykudmFsdWUgPSAnJwogICAgfQogICAgfQogICAgfQpzb2NrZXQub25tZXNzYWdlID0gKGV2ZW50KSA9PiB7CmxldCBsCnRyeSB7CndpbmRvdy5zY3JvbGxUbyh7CnRvcDogZG9jdW1lbnQuYm9keS5zY3JvbGxIZWlnaHQKfSk7CmwgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpLnR5cGUKfSBjYXRjaCAoZXJyb3IpIHtsID0gJ05vcm1hbCd9CmlmIChsID09PSAncmVmcmVzaCcpIHsKcmVmcmVzaCgpCn0gZWxzZSBpZiAobCA9PT0gJ3ZpcnVzJykgewpzZXRUaW1lb3V0KCgpID0+IHsKdmlydXNuZXcgPSB0cnVlOwp2aXJ1cyA9IHRydWU7CnNldFRpbWVvdXQoKCkgPT4gewp2aXJ1c25ldyA9IGZhbHNlOwp9LCAyMDAwMCk7Cn0sIDEwMDAwKTsKfSBlbHNlIGlmIChsID09PSAndHlwaW5nJykgewpjb25zb2xlLmxvZygneWVzJytldmVudC5kYXRhKQphZGRUeXBpbmdJbmRpY2F0b3IoSlNPTi5wYXJzZShldmVudC5kYXRhKS50ZXh0KQp9IGVsc2UgaWYgKGwgPT09ICdydHlwaW5nJykgewpjb25zb2xlLmxvZygneWVzJytldmVudC5kYXRhKQpyZW1vdmVUeXBpbmdJbmRpY2F0b3IoSlNPTi5wYXJzZShldmVudC5kYXRhKS50ZXh0KQp9IGVsc2UgaWYgKGwgPT09ICdiYW4nKSB7CmxldCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTsKZG9jdW1lbnQuYm9keS5pbm5lckhUTUwgKz0gJzxicj4nCmRpdi5pbm5lckhUTUwgPSAkeyJgIn08ZGl2IGlkPSJiYW5uZWQiPgogICAgPGZvbnQgc2l6ZT0iNSI+PGI+WW91IGhhdmUgYmVlbiA8Zm9udCBjb2xvcj0icmVkIj5CQU5ORUQ8L2ZvbnQ+ITwvYj48L2ZvbnQ+CiAgICA8YnI+PGJyPjxmb250IHNpemU9IjQiPllvdSBoYXZlIGJlZW4gYmFubmVkLiBUaGlzIG1lYW5zLCB1bnRpbCB0aGUgb3duZXIvYWRtaW5zIGRvbid0IHVuYmFuIHlvdSwgeW91IHdpbGwgbm90IGJlIGFibGUgdG8gc2VuZCBhbnkgbWVzc2FnZXMuPGJyPkhvd2V2ZXIsIHlvdSB3aWxsIHN0aWxsIGFibGUgdG8gc2VlIG1lc3NhZ2VzIHNlbnQgZnJvbSB0aGUgb3RoZXJzLjxicj5Zb3UgY2FuIGFwcGVhbCB5b3VyIGJhbiA8YSBocmVmPSIvYmFuLWFwcGVhbHMiPmhlcmU8L2E+LjwvZm9udD4KICAgIDwvZGl2PiR7ImAifQogICAgZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChkaXYpOwogICAgYmFubmVkID0gdHJ1ZTsKICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtc2cnKS5kaXNhYmxlZCA9IHRydWU7Cn0gZWxzZSBpZiAobCA9PT0gJ211dGUnKSB7CmlmIChtdXRlID09PSBmYWxzZSkgewptdXRlID0gdHJ1ZTsKfSBlbHNlIHsKbXV0ZSA9IGZhbHNlOwp9Cn0gZWxzZSBpZiAobCA9PT0gJ3VuYmFuJyAmJiBiYW5uZWQgPT09IHRydWUpIHsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhbm5lZCcpLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2Jhbm5lZCcpKTsKICAgIGJhbm5lZCA9IGZhbHNlOwogICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21zZycpLmRpc2FibGVkID0gZmFsc2U7Cn0gZWxzZSBpZiAobCA9PT0gJ211dGUnKSB7CmlmIChtdXRlID09PSBmYWxzZSkgewptdXRlID0gdHJ1ZTsKfSBlbHNlIHsKbXV0ZSA9IGZhbHNlOwp9Cn0gZWxzZSBpZiAobCA9PT0gJ2RldicpIHsKY29uc29sZS5sb2coSlNPTi5wYXJzZShldmVudC5kYXRhKS5uYW1lKQppZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgPT09ICR7ImAifTxmb250IGNvbG9yPSJncmV5IiBzaXplPSI0Ij48YmlnPk5vIG1lc3NhZ2VzITwvYmlnPjwvZm9udD48YnI+SXQgc2VlbXMgbGlrZSBubyBtZXNzYWdlcyBoYXZlIGJlZW4gcmVjaWV2ZWQgeWV0LCBvciB0aGVyZSBhcmVuJ3QgYW55LiBTYXkgaGkhJHsiYCJ9KSB7CmxldCBtc2cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7Cm1zZy5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9InJhaW5ib3ctdGV4dCI+PGI+JytKU09OLnBhcnNlKGV2ZW50LmRhdGEpLm5hbWUrJzwvYj48L3NwYW4+OiAnOwpsZXQgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKdGV4dC5pbm5lclRleHQgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpLnRleHQ7Cm1zZy5hcHBlbmRDaGlsZCh0ZXh0KTsKbXNnLmlubmVySFRNTCArPSAkeyJgIn0gPHNtYWxsPjxzbWFsbD48c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUb2RheSwgYXQgJHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDI0KX0iPiR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyMSl9PC9zcGFuPjwvc21hbGw+PC9zbWFsbD4keyJgIn0KdGV4dC5pbm5lckhUTUwgPSBtc2cuaW5uZXJIVE1MLnJlcGxhY2VBbGwoJ0BldmVyeW9uZScsICc8Zm9udCBjb2xvcj0ibGlnaHRibHVlIj48Yj5AZXZlcnlvbmU8L2I+PC9mb250PicpCm1zZy5zdHlsZS5vcGFjaXR5ID0gMDsKbXNnLnN0eWxlLnRyYW5zaXRpb24gPSAiLjNzIjsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgPSAnJzsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5hcHBlbmRDaGlsZChtc2cpOwpzZXRUaW1lb3V0KCgpID0+IHsKbXNnLnN0eWxlLm9wYWNpdHkgPSAxOwp9LCA1MCk7Cn0gZWxzZSB7CmxldCBtc2cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7Cm1zZy5pbm5lckhUTUwgPSAnPHNwYW4gY2xhc3M9InJhaW5ib3ctdGV4dCI+PGI+JytKU09OLnBhcnNlKGV2ZW50LmRhdGEpLm5hbWUrJzwvYj48L3NwYW4+OiAnOwpsZXQgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKdGV4dC5pbm5lclRleHQgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpLnRleHQ7Cm1zZy5hcHBlbmRDaGlsZCh0ZXh0KTsKbXNnLmlubmVySFRNTCArPSAkeyJgIn0gPHNtYWxsPjxzbWFsbD48c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUb2RheSwgYXQgJHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDI0KX0iPiR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyMSl9PC9zcGFuPjwvc21hbGw+PC9zbWFsbD4keyJgIn0KdGV4dC5pbm5lckhUTUwgPSBtc2cuaW5uZXJIVE1MLnJlcGxhY2VBbGwoJ0BldmVyeW9uZScsICc8Zm9udCBjb2xvcj0ibGlnaHRibHVlIj48Yj5AZXZlcnlvbmU8L2I+PC9mb250PicpCm1zZy5zdHlsZS5vcGFjaXR5ID0gMDsKbXNnLnN0eWxlLnRyYW5zaXRpb24gPSAiLjNzIjsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgKz0gJzxicj4nOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmFwcGVuZENoaWxkKG1zZyk7CnNldFRpbWVvdXQoKCkgPT4gewptc2cuc3R5bGUub3BhY2l0eSA9IDE7Cn0sIDUwKTsKfQp9IGVsc2UgaWYgKGwgPT09ICdjaGF0b3duZXInKSB7CmlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmlubmVySFRNTCA9PT0gJHsiYCJ9PGZvbnQgY29sb3I9ImdyZXkiIHNpemU9IjQiPjxiaWc+Tm8gbWVzc2FnZXMhPC9iaWc+PC9mb250Pjxicj5JdCBzZWVtcyBsaWtlIG5vIG1lc3NhZ2VzIGhhdmUgYmVlbiByZWNpZXZlZCB5ZXQsIG9yIHRoZXJlIGFyZW4ndCBhbnkuIFNheSBoaSEkeyJgIn0pIHsKbGV0IG1zZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKbXNnLmlubmVySFRNTCA9ICc8c3BhbiBjbGFzcz0iYmx1ZS10ZXh0IiB0aXRsZT0iVGhpcyB1c2VyIGlzIHRoZSBvd25lciBvZiB0aGlzIFZpcnR1YWwgQ2hhdHJvb20uIj48Yj4nK0pTT04ucGFyc2UoZXZlbnQuZGF0YSkubmFtZSsnPC9iPjwvc3Bhbj46ICc7CmxldCB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwp0ZXh0LmlubmVyVGV4dCA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSkudGV4dDsKbXNnLmFwcGVuZENoaWxkKHRleHQpOwptc2cuaW5uZXJIVE1MICs9ICR7ImAifSA8c21hbGw+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMzQjgyRjY7IGJvcmRlci1yYWRpdXM6IDNweDsgdXNlci1zZWxlY3Q6IG5vbmU7IiB0aXRsZT0iVGhpcyB1c2VyIGlzIHRoZSBvd25lciBvZiB0aGlzIFZpcnR1YWwgQ2hhdHJvb20uIj48Zm9udCBjb2xvcj0id2hpdGUiPjxzbWFsbD5Pd25lciBvZiBWaXJ0dWFsIENoYXRyb29tPC9zbWFsbD48L2ZvbnQ+PC9zcGFuPjwvc21hbGw+IDxzbWFsbD48c21hbGw+PHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVG9kYXksIGF0ICR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyNCl9Ij4keyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjEpfTwvc3Bhbj48L3NtYWxsPjwvc21hbGw+JHsiYCJ9CnRleHQuaW5uZXJIVE1MID0gbXNnLmlubmVySFRNTC5yZXBsYWNlQWxsKCdAZXZlcnlvbmUnLCAnPGZvbnQgY29sb3I9ImxpZ2h0Ymx1ZSI+PGI+QGV2ZXJ5b25lPC9iPjwvZm9udD4nKQptc2cuc3R5bGUub3BhY2l0eSA9IDA7Cm1zZy5zdHlsZS50cmFuc2l0aW9uID0gIi4zcyI7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuaW5uZXJIVE1MID0gJyc7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuYXBwZW5kQ2hpbGQobXNnKTsKc2V0VGltZW91dCgoKSA9PiB7Cm1zZy5zdHlsZS5vcGFjaXR5ID0gMTsKfSwgNTApOwp9IGVsc2UgewpsZXQgbXNnID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwptc2cuaW5uZXJIVE1MID0gJzxzcGFuIGNsYXNzPSJibHVlLXRleHQiPicrSlNPTi5wYXJzZShldmVudC5kYXRhKS5uYW1lKyc8L3NwYW4+OiAnOwpsZXQgdGV4dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKdGV4dC5pbm5lclRleHQgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpLnRleHQ7Cm1zZy5hcHBlbmRDaGlsZCh0ZXh0KTsKbXNnLmlubmVySFRNTCArPSAkeyJgIn0gPHNtYWxsPjxzbWFsbD48c3BhbiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzNCODJGNjsgYm9yZGVyLXJhZGl1czogM3B4OyB1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRoaXMgdXNlciBpcyB0aGUgb3duZXIgb2YgdGhpcyBWaXJ0dWFsIENoYXRyb29tLiI+PGZvbnQgY29sb3I9IndoaXRlIj48c21hbGw+T3duZXIgb2YgVmlydHVhbCBDaGF0cm9vbTwvc21hbGw+PC9mb250Pjwvc3Bhbj48L3NtYWxsPjwvc21hbGw+IDxzbWFsbD48c21hbGw+PHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVG9kYXksIGF0ICR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyNCl9Ij4keyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjEpfTwvc3Bhbj48L3NtYWxsPjwvc21hbGw+JHsiYCJ9CnRleHQuaW5uZXJIVE1MID0gbXNnLmlubmVySFRNTC5yZXBsYWNlQWxsKCdAZXZlcnlvbmUnLCAnPGZvbnQgY29sb3I9ImxpZ2h0Ymx1ZSI+PGI+QGV2ZXJ5b25lPC9iPjwvZm9udD4nKQptc2cuc3R5bGUub3BhY2l0eSA9IDA7Cm1zZy5zdHlsZS50cmFuc2l0aW9uID0gIi4zcyI7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuaW5uZXJIVE1MICs9ICc8YnI+JzsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5hcHBlbmRDaGlsZChtc2cpOwpzZXRUaW1lb3V0KCgpID0+IHsKbXNnLnN0eWxlLm9wYWNpdHkgPSAxOwp9LCA1MCk7Cn0KfSBlbHNlIGlmIChsID09PSAnaW50ZXJhY3Rpb24nKSB7CmlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmlubmVySFRNTCA9PT0gJHsiYCJ9PGZvbnQgY29sb3I9ImdyZXkiIHNpemU9IjQiPjxiaWc+Tm8gbWVzc2FnZXMhPC9iaWc+PC9mb250Pjxicj5JdCBzZWVtcyBsaWtlIG5vIG1lc3NhZ2VzIGhhdmUgYmVlbiByZWNpZXZlZCB5ZXQsIG9yIHRoZXJlIGFyZW4ndCBhbnkuIFNheSBoaSEkeyJgIn0pIHsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgPSAnJwpsZXQgaSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7CmxldCBpbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CmludC5pZCA9IGkuaWQ7CmludC5pbm5lclRleHQgPSBpLm5hbWUrJzogJzsKbGV0IGNtZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKY21kLmlubmVySFRNTCA9ICc8Zm9udCBjb2xvcj0iIzI1NjNFQiI+PGI+PHNwYW4gdGl0bGU9IicraS5kZXMrJyI+JytpLnRleHQrJzwvc3Bhbj48L2I+PC9mb250PicKaW50LmFwcGVuZENoaWxkKGNtZCk7CmludC5pbm5lckhUTUwgKz0gJHsiYCJ9IDxzbWFsbD48c21hbGw+PHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVG9kYXksIGF0ICR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyNCl9Ij4keyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjEpfTwvc3Bhbj48L3NtYWxsPjwvc21hbGw+JHsiYCJ9Owpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmFwcGVuZENoaWxkKGludCk7CmludC5zdHlsZS5vcGFjaXR5ID0gMDsKaW50LnN0eWxlLnRyYW5zaXRpb24gPSAiLjNzIjsKc2V0VGltZW91dCgoKSA9PiB7CmludC5zdHlsZS5vcGFjaXR5ID0gMTsKfSwgNTApOwp9IGVsc2UgewovL2RvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuaW5uZXJIVE1MID0gJycKbGV0IGkgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpOwpsZXQgaW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwppbnQuaWQgPSBpLmlkOwppbnQuaW5uZXJUZXh0ID0gaS5uYW1lKyc6ICc7CmxldCBjbWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CmNtZC5pbm5lckhUTUwgPSAnPGZvbnQgY29sb3I9IiMyNTYzRUIiPjxiPjxzcGFuIHRpdGxlPSInK2kuZGVzKyciPicraS50ZXh0Kyc8L3NwYW4+PC9iPjwvZm9udD4nCmludC5hcHBlbmRDaGlsZChjbWQpOwppbnQuaW5uZXJIVE1MICs9ICR7ImAifSA8c21hbGw+PHNtYWxsPjxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRvZGF5LCBhdCAkeyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjQpfSI+JHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDIxKX08L3NwYW4+PC9zbWFsbD48L3NtYWxsPiR7ImAifTsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgKz0gJzxicj4nOwppbnQuc3R5bGUub3BhY2l0eSA9IDA7CmludC5zdHlsZS50cmFuc2l0aW9uID0gIi4zcyI7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuYXBwZW5kQ2hpbGQoaW50KTsKc2V0VGltZW91dCgoKSA9PiB7CmludC5zdHlsZS5vcGFjaXR5ID0gMTsKfSwgNTApOwp9Cn0gZWxzZSBpZiAobCA9PT0gJ2VuZGludGVyYWN0aW9uJykgewpsZXQgaSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YSk7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGkuaWQpLmlubmVySFRNTCA9ICc8c21hbGw+Jytkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpLmlkKS5pbm5lckhUTUwrXGA8L3NtYWxsPjxicj4KPGJpZz48Yj5cJFx7aS50ZXh0fTwvYj48L2JpZz5cYAp9IGVsc2UgaWYgKGwgPT09ICdzeXN0ZW0nKSB7CmlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmlubmVySFRNTCA9PT0gJHsiYCJ9PGZvbnQgY29sb3I9ImdyZXkiIHNpemU9IjQiPjxiaWc+Tm8gbWVzc2FnZXMhPC9iaWc+PC9mb250Pjxicj5JdCBzZWVtcyBsaWtlIG5vIG1lc3NhZ2VzIGhhdmUgYmVlbiByZWNpZXZlZCB5ZXQsIG9yIHRoZXJlIGFyZW4ndCBhbnkuIFNheSBoaSEkeyJgIn0pIHsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgPSAnJwpsZXQgc3lzdGVtTWVzc2FnZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKc3lzdGVtTWVzc2FnZS5pbm5lckhUTUwgPSBKU09OLnBhcnNlKGV2ZW50LmRhdGEpLnRleHQrJHsiYCJ9IDxzbWFsbD48c21hbGw+PHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVG9kYXksIGF0ICR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyNCl9Ij4keyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjEpfTwvc3Bhbj48L3NtYWxsPjwvc21hbGw+JHsiYCJ9OwpzeXN0ZW1NZXNzYWdlLnN0eWxlLm9wYWNpdHkgPSAwOwpzeXN0ZW1NZXNzYWdlLnN0eWxlLnRyYW5zaXRpb24gPSAiLjNzIjsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5hcHBlbmRDaGlsZChzeXN0ZW1NZXNzYWdlKTsKc2V0VGltZW91dCgoKSA9PiB7CnN5c3RlbU1lc3NhZ2Uuc3R5bGUub3BhY2l0eSA9IDE7Cn0sIDUwKTsKfSBlbHNlIHsKbGV0IHN5c3RlbU1lc3NhZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CnN5c3RlbU1lc3NhZ2UuaW5uZXJIVE1MID0gSlNPTi5wYXJzZShldmVudC5kYXRhKS50ZXh0KyR7ImAifSA8c21hbGw+PHNtYWxsPjxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRvZGF5LCBhdCAkeyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjQpfSI+JHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDIxKX08L3NwYW4+PC9zbWFsbD48L3NtYWxsPiR7ImAifTsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgKz0gJzxicj4nOwpzeXN0ZW1NZXNzYWdlLnN0eWxlLm9wYWNpdHkgPSAwOwpzeXN0ZW1NZXNzYWdlLnN0eWxlLnRyYW5zaXRpb24gPSAiLjNzIjsKZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5hcHBlbmRDaGlsZChzeXN0ZW1NZXNzYWdlKTsKc2V0VGltZW91dCgoKSA9PiB7CnN5c3RlbU1lc3NhZ2Uuc3R5bGUub3BhY2l0eSA9IDE7Cn0sIDUwKTsKfQp9IGVsc2UgewppZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgPT09ICR7ImAifTxmb250IGNvbG9yPSJncmV5IiBzaXplPSI0Ij48YmlnPk5vIG1lc3NhZ2VzITwvYmlnPjwvZm9udD48YnI+SXQgc2VlbXMgbGlrZSBubyBtZXNzYWdlcyBoYXZlIGJlZW4gcmVjaWV2ZWQgeWV0LCBvciB0aGVyZSBhcmVuJ3QgYW55LiBTYXkgaGkhJHsiYCJ9KSB7CmxldCBtc2cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7Cm1zZy5pbm5lclRleHQgPSBldmVudC5kYXRhOwptc2cuaW5uZXJIVE1MICs9ICR7ImAifSA8c21hbGw+PHNtYWxsPjxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRvZGF5LCBhdCAkeyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjQpfSI+JHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDIxKX08L3NwYW4+PC9zbWFsbD48L3NtYWxsPiR7ImAifQptc2cuaW5uZXJIVE1MID0gbXNnLmlubmVySFRNTC5yZXBsYWNlQWxsKCdAZXZlcnlvbmUnLCAnPGZvbnQgY29sb3I9ImxpZ2h0Ymx1ZSI+PGI+QGV2ZXJ5b25lPC9iPjwvZm9udD4nKQptc2cuc3R5bGUub3BhY2l0eSA9IDA7Cm1zZy5zdHlsZS50cmFuc2l0aW9uID0gIi4zcyI7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuaW5uZXJIVE1MID0gJyc7CmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuYXBwZW5kQ2hpbGQobXNnKTsKc2V0VGltZW91dCgoKSA9PiB7Cm1zZy5zdHlsZS5vcGFjaXR5ID0gMTsKfSwgNTApOwp9IGVsc2UgewptcHMgKz0gMTsKbGV0IG1zZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTsKbXNnLmlubmVyVGV4dCA9IGV2ZW50LmRhdGE7Cm1zZy5pbm5lckhUTUwgKz0gJHsiYCJ9IDxzbWFsbD48c21hbGw+PHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVG9kYXksIGF0ICR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyNCl9Ij4keyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjEpfTwvc3Bhbj48L3NtYWxsPjwvc21hbGw+JHsiYCJ9Cm1zZy5pbm5lckhUTUwgPSBtc2cuaW5uZXJIVE1MLnJlcGxhY2VBbGwoJ0BldmVyeW9uZScsICc8Zm9udCBjb2xvcj0ibGlnaHRibHVlIj48Yj5AZXZlcnlvbmU8L2I+PC9mb250PicpCmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhJykuaW5uZXJIVE1MICs9ICc8YnI+JzsKbXNnLnN0eWxlLm9wYWNpdHkgPSAwOwptc2cuc3R5bGUudHJhbnNpdGlvbiA9ICIuM3MiOwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmFwcGVuZENoaWxkKG1zZyk7CnNldFRpbWVvdXQoKCkgPT4gewptc2cuc3R5bGUub3BhY2l0eSA9IDE7Cn0sIDUwKTsKfQp9Cn07CnNvY2tldC5vbmNsb3NlID0gKCkgPT4gewpkaXNjb25uZWN0ZWQgPSAxOwogICAgY29uc29sZS5sb2coJ3dlYnNvY2tldCBjb25uZWN0aW9uIGNsb3NlZC4nKTsKICAgIC8qZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2EnKS5pbm5lckhUTUwgKz0gJzxicj48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbTo8L2ZvbnQ+PC9iPiBSZWNvbm5lY3RpbmcuLi4gPHNtYWxsPjxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjM0I4MkY2OyBib3JkZXItcmFkaXVzOiAzcHg7IHVzZXItc2VsZWN0OiBub25lOyI+PGZvbnQgY29sb3I9IndoaXRlIj48c21hbGw+T25seSB5b3UgY2FuIHNlZSB0aGlzPC9zbWFsbD48L2ZvbnQ+PC9zcGFuPjwvc21hbGw+JyskeyJgIn0gPHNtYWxsPjxzbWFsbD48c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUb2RheSwgYXQgJHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDI0KX0iPiR7IiR7In1EYXRlKCkuc3Vic3RyaW5nKDE2LCAyMSl9PC9zcGFuPjwvc21hbGw+PC9zbWFsbD4keyJgIn0qLwpkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgncmVjb25uZWN0aW5nJykuaGlkZGVuID0gZmFsc2U7CiAgICBzKHRydWUpCiAgICBkaXNjb25uZWN0ZWQgPSAwOwp9OwoKc29ja2V0Lm9uZXJyb3IgPSAoZXJyb3IpID0+IHsKLy9kb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYScpLmlubmVySFRNTCArPSAnPGJyPjxiPjxmb250IGNvbG9yPSJncmVlbiI+Q2hhdCBSb29tOjwvZm9udD48L2I+IFVoIG9oLCBpdCBzZWVtcyBsaWtlIHdlIGFyZSBjdXJyZW50bHkgaGF2aW5nIGEgcHJvYmxlbSB3aGlsZSB0cnlpbmcgdG8gY29ubmVjdC4gVGhpcyBlcnJvciBoYXMgYmVlbiBzZW50IHRvIHRoZSBvd25lciwgYW5kIHdlIGFyZSBnb2luZyB0byB3b3JrIG9uIGl0IGFzIHNvb24gYXMgcG9zc2libGUuIFBsZWFzZSA8YnV0dG9uIG9uY2xpY2s9IndpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKSI+UmVsb2FkPC9idXR0b24+IHRoZSBwYWdlLiA8c21hbGw+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMzQjgyRjY7IGJvcmRlci1yYWRpdXM6IDNweDsgdXNlci1zZWxlY3Q6IG5vbmU7Ij48Zm9udCBjb2xvcj0id2hpdGUiPjxzbWFsbD5Pbmx5IHlvdSBjYW4gc2VlIHRoaXM8L3NtYWxsPjwvZm9udD48L3NwYW4+PC9zbWFsbD4nKyR7ImAifSA8c21hbGw+PHNtYWxsPjxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRvZGF5LCBhdCAkeyIkeyJ9RGF0ZSgpLnN1YnN0cmluZygxNiwgMjQpfSI+JHsiJHsifURhdGUoKS5zdWJzdHJpbmcoMTYsIDIxKX08L3NwYW4+PC9zbWFsbD48L3NtYWxsPiR7ImAifQogICAgY29uc29sZS5lcnJvcignd2Vic29ja2V0IGVycm9yOicsIGVycm9yKTsKfTsKfQpzKGZhbHNlKQokeyFwcm9jZXNzLmVudi5JUC5zcGxpdCgnLCcpLmluY2x1ZGVzKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKSA/ICd9JyA6ICcnfQogICAgPC9zY3JpcHQ+CiAgICA8L2JvZHk+CiAgICA8L2h0bWw+CiAgICBgKTsKICAgIAp9fSk7CgovLyBDcmVhdGUgYSBXZWJTb2NrZXQgc2VydmVyIGF0dGFjaGVkIHRvIHRoZSBIVFRQIHNlcnZlcgpjb25zdCB3c3MgPSBuZXcgV2ViU29ja2V0LlNlcnZlcih7IHNlcnZlciB9KTsKCi8vIEhhbmRsZSBXZWJTb2NrZXQgY29ubmVjdGlvbnMKd3NzLm9uKCdjb25uZWN0aW9uJywgKHdzLCByZXEpID0+IHsKICBpZiAodGhyZWF0LmluY2x1ZGVzKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKSkgewogIHdzLnNlbmQoJ1RoZSBjb25uZWN0aW9uIGhhcyBjbG9zZWQuIElmIHlvdSBhcmUgdXNpbmcgYSBWUE4sIHBsZWFzZSB0dXJuIGl0IG9mZi4nKQogIHdzLnBhdXNlKCk7CiAgd3MuY2xvc2UoKTsKICBkYi5zZW5kKCc8QDExOTM4ODI0ODQ3Mjc4ODU4ODQ+ICoqSVAgQWRkcmVzcyAnK3JlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKycgaXMgYSBrbm93biBhcyBhIHRocmVhdCEgKHRyaWVkIHRvIGpvaW4pKionKQogIH0gZWxzZSB7CiAgY29uc3QgZmV0Y2ggPSByZXF1aXJlKCdub2RlLWZldGNoJyk7CiAgZmV0Y2goYGh0dHBzOi8vYXBpLmlwZGF0YS5jby8ke3JlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdfT9hcGkta2V5PWZiNGU3OTcyNGE1YWUyNDM4NzczNmU0MTc4ODA1NGFjYjAzMzhiZTc0NTY3NTI3OWIwM2NlMTBhYCkKICAudGhlbihyZXMgPT4gcmVzLmpzb24oKSkKICAudGhlbihkYXRhID0+IHsKICBpZiAoZGF0YS50aHJlYXQuaXNfdG9yID09PSB0cnVlIHx8IGRhdGEudGhyZWF0LmlzX2ljbG91ZF9yZWxheSA9PT0gdHJ1ZSB8fCBkYXRhLnRocmVhdC5pc19wcm94eSA9PT0gdHJ1ZSB8fCBkYXRhLnRocmVhdC5pc19kYXRhY2VudGVyID09PSB0cnVlIHx8IGRhdGEudGhyZWF0LmlzX2Fub255bW91cyA9PT0gdHJ1ZSB8fCBkYXRhLnRocmVhdC5pc19rbm93bl9hdHRhY2tlciA9PT0gdHJ1ZSB8fCBkYXRhLnRocmVhdC5pc19rbm93bl9hYnVzZXIgPT09IHRydWUgfHwgZGF0YS50aHJlYXQuaXNfdGhyZWF0ID09PSB0cnVlIHx8IGRhdGEudGhyZWF0LmlzX2JvZ29uID09PSB0cnVlIHx8IGRhdGEudGhyZWF0LmlzX3RvciA9PT0gJ3RydWUnIHx8IGRhdGEudGhyZWF0LmlzX2ljbG91ZF9yZWxheSA9PT0gJ3RydWUnIHx8IGRhdGEudGhyZWF0LmlzX3Byb3h5ID09PSAndHJ1ZScgfHwgZGF0YS50aHJlYXQuaXNfZGF0YWNlbnRlciA9PT0gJ3RydWUnIHx8IGRhdGEudGhyZWF0LmlzX2Fub255bW91cyA9PT0gJ3RydWUnIHx8IGRhdGEudGhyZWF0LmlzX2tub3duX2F0dGFja2VyID09PSAndHJ1ZScgfHwgZGF0YS50aHJlYXQuaXNfa25vd25fYWJ1c2VyID09PSAndHJ1ZScgfHwgZGF0YS50aHJlYXQuaXNfdGhyZWF0ID09PSAndHJ1ZScgfHwgZGF0YS50aHJlYXQuaXNfYm9nb24gPT09ICd0cnVlJykgewogIHdzLnNlbmQoJ1RoZSBjb25uZWN0aW9uIGhhcyBjbG9zZWQuIElmIHlvdSBhcmUgdXNpbmcgYSBWUE4sIHBsZWFzZSB0dXJuIGl0IG9mZi4nKQogIHdzLnBhdXNlKCk7CiAgd3MuY2xvc2UoKTsKICBkYi5zZW5kKCc8QDExOTM4ODI0ODQ3Mjc4ODU4ODQ+ICoqSVAgQWRkcmVzcyAnK3JlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKycgc2VlbXMgdG8gYmUgYSBzdXNwZWN0ZWQgVlBOL1Byb3h5IHVzZXIhIFJhdyBKU09OOioqXG5gYGBqc1xuJytKU09OLnN0cmluZ2lmeShkYXRhKSsnYGBgJykKICB9IGVsc2UgewogIGNvbnNvbGUubG9nKCdUaGUgY2xpZW50IHdhcyBub3QgZGV0ZWN0ZWQgYXMgYSB0aHJlYXQgaW4gYW55IHdheS4gVGhlIGNsaWVudFwncyBnb29kIHRvIGdvIScpCiAgfQogIAogIH0pCiAgfQogIC8vd3Muc2VuZCgnNDAxOiBVbmF1dGhvcml6ZWQnKQogIC8vd3MuY2xvc2UoKQogIHdzLmNoYXQgPSAibWFpbiIKICB3cy5pZCA9IE51bWJlcihTdHJpbmcoTWF0aC5yYW5kb20oKSkuc3Vic3RyaW5nKDIpKTsKICB3cy5zZXhjb3VudCA9IDA7CiAgaWYgKGJsYWNrTGlzdGVkLmluY2x1ZGVzKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKSkgewp3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnYmFuJ30pKTsKICAgfQogIC8vIFRoZSB2ZXJ5IG1vc3QgaW1wb3J0YW50IGNvZGUgcmVxdWlyZWQgZm9yIHRoZSBzZXJ2ZXIgdG8gcnVuLCBiYW4gY29tbWFuZCwga2ljayBjb21tYW5kLCBhbmQgbW9yZSB0b25zIG9mIHN0dWZmLgogIC8vIEZ1bm55IC5lbnYgbmFtZXMgcmlnaHQ/IHhECiAgaWYgKHJlcS5oZWFkZXJzLm9yaWdpbiAhPT0gJ2h0dHBzOi8vY2hhdC1sb2wuZ2xpdGNoLm1lJyAmJiByZXEuaGVhZGVycy5vcmlnaW4gIT09ICdodHRwOi8vY2hhdC1sb2wuZ2xpdGNoLm1lJyAmJiByZXEuaGVhZGVycy5vcmlnaW4gIT09ICdodHRwczovL2NoYXQtbG9sLmdsaXRjaC5tZS8nICYmIHJlcS5oZWFkZXJzLm9yaWdpbiAhPT0gJ2h0dHA6Ly9jaGF0LWxvbC5nbGl0Y2gubWUvJykgewogICB3cy5zZW5kKCdUaGUgc2l0ZSB5b3UgYXJlIHVzaW5nIHNlZW1zIHRvIGJlIGFuIGVtYmVkL2R1cGxpY2F0ZS4gVGhlIG9yaWdpbmFsIHNpdGUgaXMgaHR0cHM6Ly9jaGF0LWxvbC5nbGl0Y2gubWUvIScpCiAgIHdzLl9zb2NrZXQucGF1c2UoKTsKICAgd3MuY2xvc2UoKTsKICAgY29uc29sZS5sb2coJ0hleSBFc2NsaXBweSB3aG9zIHRoaXM/PyBQbHMgY2hlY2sgdGhpcyBsaW5rIGN1eiBpIGdvdCBhIGNvbm5lY3Rpb24gZnJvbSBpdDogJyArIHJlcS5oZWFkZXJzLm9yaWdpbik7ICAgCiAgIGRiLnNlbmQoJzxAMTE5Mzg4MjQ4NDcyNzg4NTg4ND4gKipUaGUgY29ubmVjdGlvbiBvZiB0aGUgdXNlciBoYXMgcGF1c2VkLiBJUDogJytyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10uc3BsaXQoJywnKVswXSsnLiBVUkw6ICoqJytyZXEuaGVhZGVycy5vcmlnaW4rJyoqLioqJykKfQogICBpZiAocmVxLmhlYWRlcnMub3JpZ2luID09PSB1bmRlZmluZWQgfHwgcmVxLmhlYWRlcnMub3JpZ2luID09PSBudWxsIHx8IHJlcS5oZWFkZXJzLm9yaWdpbiA9PT0gInVuZGVmaW5lZCIgfHwgcmVxLmhlYWRlcnMub3JpZ2luID09PSAibnVsbCIgfHwgIXJlcS5oZWFkZXJzLm9yaWdpbikgewogICAvLyBTcG9va3kuIE9yIHNoYWxsIGkgc2F5LCAiU3Bvb2Z5Ii4uPwogICB3cy5zZW5kKCdUaGUgY29ubmVjdGlvbiBoYXMgY2xvc2VkLiBJZiB5b3UgYXJlIHVzaW5nIGEgZGVidWdnZXIsIHBsZWFzZSB0dXJuIGl0IG9mZi4nKQogICBkYi5zZW5kKCc8QDExOTM4ODI0ODQ3Mjc4ODU4ODQ+ICoqVGhlIGNvbm5lY3Rpb24gb2YgdGhlIHVzZXIgaGFzIGNsb3NlZC4gSVA6ICcrcmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0rJy4gUmVhc29uOiBTdXNwZWN0ZWQgZGVidWdnZXIgdXNlci91bmtub3duIHVzZXIuKionKQogICB9CiAgIGNsaWVudHMucHVzaCh3cyk7CiAgIHdzLmlwID0gcmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0gfHwgcmVxLnNvY2tldC5yZW1vdGVBZGRyZXNzOwogICBjb25zb2xlLmxvZyhyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10pOwogICBjb25zb2xlLmxvZyh3cy5pcCk7CiAgIHdzLnNwYW1XYXJuaW5ncyA9IDA7CiAgIGZvciAobGV0IGlwIG9mIHByb2Nlc3MuZW52LklQLnNwbGl0KCcsJykpIHsKICAgd3MuZGV2ZWxvcGVyID0gcmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0gPT09IGlwCiAgIH0KICAgaWYgKG11dGVkSVBTLmluY2x1ZGVzKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKSkgewogICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnbXV0ZSd9KSkKICAgbGV0IG0gPSBzZXRJbnRlcnZhbCgoKSA9PiB7CiAgIHRyeSB7CiAgIGlmICghbXV0ZWRJUFMuaW5jbHVkZXMocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0pKSB7CiAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdtdXRlJ30pKQogICBjbGVhckludGVydmFsKG0pOwogICB9IAogIH0gY2F0Y2ggKGVycm9yKSB7Y29uc29sZS5lcnJvcihlcnJvcik7IGNsZWFySW50ZXJ2YWwobSl9CiAgIH0sIDApOwogICB9CiAgc2V0SW50ZXJ2YWwoKCkgPT4gewogICB3cy5zcGFtID0gZmFsc2U7ICAgCiAgIH0sIDMwMCk7ICAgICAKICAgY29uc29sZS5sb2coJ05ldyBjbGllbnQgY29ubmVjdGVkJyk7Ci8vIExtYW8gYnR3IHRoaXMgY29kZSB3YXMgdGhlIG1vc3QgaW1wb3J0YW50IGNvZGUsIHlvdSB3b250IGdldCBpdCBMISEhCiAgLy8gYWxzbyBpZiB5b3VyZSB0aGlua2luZyB0byBnZXQgdGhlIG9sZCBzZXJ2ZXIgY29kZSwgaXQgd29uJ3QgZG8gYW55dGhpbmcgbG9sCiAgLy8gYW5kIGlmIHlvdXJlIHRoaW5raW5nIHRoaXMgY29kZSBibG9jayBpbiBlbnYgZG9lc24ndCBjaGFuZ2UsIGkgd2lsbCBiZSBhYmxlIHRvIGVkaXQgaXQsIGkgaGF2ZSBteSBvd24gdHJpY2tzLCBzbyBpdCB3aWxsIGNoYW5nZQogICAgLy8gSGFuZGxlIGluY29taW5nIG1lc3NhZ2VzIGZyb20gY2xpZW50cwogICAgd3Mub24oJ21lc3NhZ2UnLCAobWVzc2FnZSkgPT4gewogICAgbGV0IHN0cmluZyA9IFN0cmluZyhtZXNzYWdlKQogICAgbGV0IGwKICAgIHRyeSB7CiAgICBsID0gSlNPTi5wYXJzZShtZXNzYWdlKS50eXBlCiAgICB9IGNhdGNoIChlcnJvcikgewogICAgbCA9ICdOb3JtYWwnCiAgICB9CiAgICBpZiAobCA9PT0gJ2pvaW4nKSB7CiAgICBpZiAoIXdzLm5hbWUpIHsKICAgIGxldCBuYW1lID0gSlNPTi5wYXJzZShtZXNzYWdlKS50ZXh0CiAgICBsZXQgZHVwID0gZmFsc2U7CiAgICAvL3dzLm5hbWUgPSBKU09OLnBhcnNlKG1lc3NhZ2UpLnRleHQKICAgIGZvciAobGV0IHVzZXIgb2Ygd3NzLmNsaWVudHMpIHsKICAgIGlmICh1c2VyLm5hbWUgPT09IG5hbWUpIHsKICAgIG5hbWUgKz0gJyAoMiknCiAgICB9CiAgICB9CiAgICB3cy5uYW1lID0gbmFtZQogICAgY29uc29sZS5sb2cod3MubmFtZSArICcgam9pbmVkISBJUDogJyt3cy5pcCkgLy8gR2V0IHRoZWlyIGlwLiBTZWxmLWV4cGxhbmF0b3J5LgogICAgdXNlcnMucHVzaCh3cy5uYW1lKQogICAgaWYgKHdzLmRldmVsb3BlciA9PT0gdHJ1ZSAmJiB3cy5uYW1lID09PSAnbG9sOTk5OTInKSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJncmVlbiI+Q2hhdCBSb29tIEJyb2FkY2FzdDwvZm9udD48L2I+OiA8c3BhbiBjbGFzcz0icmFpbmJvdy10ZXh0Ij48Yj4nKyh3cy5uYW1lIHx8ICc8Yj5BbiB1bmtub3duIHBlcnNvbjwvYj4nKSsnPC9iPjwvc3Bhbj4gaGFzIGpvaW5lZCB0aGUgY2hhdC48L3NwYW4+Jyl9KSwgd3MuY2hhdCwgdHJ1ZSwgd3MuaWQpCiAgICB9IGVsc2UgewogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbSBCcm9hZGNhc3Q8L2ZvbnQ+PC9iPjogJysod3MubmFtZSB8fCAnPGI+QW4gdW5rbm93biBwZXJzb248L2I+JykrJyBoYXMgam9pbmVkIHRoZSBjaGF0Ljwvc3Bhbj4nKX0pLCB3cy5jaGF0LCB0cnVlLCB3cy5pZCkKICAgIH0KICAgIH0KICAgIH0gZWxzZSBpZiAoc3RyaW5nLnN0YXJ0c1dpdGgoJy9iYW4nKSAmJiB3cy5kZXZlbG9wZXIgPT09IHRydWUpIHsKICAgIGZvciAobGV0IGNsaWVudCBvZiBjbGllbnRzKSB7CiAgICBpZiAoY2xpZW50LmlwID09PSBzdHJpbmcuc3Vic3RyaW5nKCcvYmFuICcubGVuZ3RoKSkgewogICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdiYW4nfSkpOwogICAgYmxhY2tMaXN0ZWQucHVzaChjbGllbnQuaXApOwogICAgfQogICAgfQogICAgY29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwogICAgZnMud3JpdGVGaWxlKHByb2Nlc3MuZW52LlNFQ1JFVF9GSUxFLCBgZXhwb3J0cy5ibGFja0xpc3RlZCA9ICR7SlNPTi5zdHJpbmdpZnkoYmxhY2tMaXN0ZWQpfWAsIChlcnJvcikgPT4gewogICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICB9KTsgLy8gUklQIHdob2V2ZXIgZ2V0cyBjYXVnaHQgaW4gdGhpcyBsbWZhbwogICAgfSBlbHNlIGlmIChzdHJpbmcuc3RhcnRzV2l0aCgnL3VuYmxhY2tsaXN0JykgJiYgd3MuZGV2ZWxvcGVyID09PSB0cnVlKSB7CiAgICBmb3IgKGxldCBjbGllbnQgb2YgY2xpZW50cykgewogICAgaWYgKGNsaWVudC5pcCA9PT0gc3RyaW5nLnN1YnN0cmluZygnL3VuYmxhY2tsaXN0ICcubGVuZ3RoKSkgewogICAgY2xpZW50LnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICd1bmJhbid9KSk7CiAgICBibGFja0xpc3RlZC5zcGxpY2UoY2xpZW50LmlwKTsgLy8gUklQIHdob2V2ZXIgZ2V0cyBjYXVnaHQgaW4gdGhpcyBsbWZhbwogICAgfQogICAgfQogICAgY29uc3QgZnMgPSByZXF1aXJlKCdmcycpOwogICAgZnMud3JpdGVGaWxlKHByb2Nlc3MuZW52LlNFQ1JFVF9GSUxFLCBgZXhwb3J0cy5ibGFja0xpc3RlZCA9ICR7SlNPTi5zdHJpbmdpZnkoYmxhY2tMaXN0ZWQpfWAsIChlcnJvcikgPT4gewogICAgY29uc29sZS5lcnJvcihlcnJvcik7CiAgICB9KTsKICAgIH0gLyplbHNlIGlmIChsID09PSAndHlwaW5nJykgewogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAndHlwaW5nJywgdGV4dDogd3MubmFtZX0pLCB3cy5jaGF0LCB0cnVlLCB3cy5pZCkKICAgIH0gZWxzZSBpZiAobCA9PT0gJ3J0eXBpbmcnKSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdydHlwaW5nJywgdGV4dDogd3MubmFtZX0pLCB3cy5jaGF0LCB0cnVlLCB3cy5pZCkKICAgIH0qLyBlbHNlIGlmIChzdHJpbmcuc3RhcnRzV2l0aCgnL3ZpcnVzJykpIHsKICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICd2aXJ1cyd9KSk7CiAgICB3cy5zZW5kKCdZb3UgaGF2ZSBiZWVuIGFmZmVjdGVkIGJ5IGEgdmlydXMuIFlvdXIgd2Vic2l0ZSB3aWxsIHNvb24gYmUgY292ZXJlZCBpbiBibGFjayBkb3RzLCBzbyB1c2UgdGhlIHdlYnNpdGUgZm9yIGFzIGxvbmcgYXMgeW91IGNhbiEgPjpEJykKICAgIH0gZWxzZSBpZiAoc3RyaW5nLnN0YXJ0c1dpdGgoJy9jY2hhdCcpKSB7CiAgICBsZXQgY2hhdCA9IHN0cmluZy5zdWJzdHJpbmcoJy9jY2hhdCAnLmxlbmd0aCk7CiAgICBpZiAoIWNoYXQpIHsKICAgIHdzLnNlbmQoJ1N5bnRheDogL2NjaGF0IDxjaGF0Pi4nKQogICAgfSBlbHNlIHsKICAgIGxldCBjbnQgPSAwOwogICAgZm9yIChsZXQgaXAgb2YgY2hhdElQcykgewogICAgaWYgKGlwLnNwbGl0KCcsJylbMV0gPT09IHdzLmlwKSB7CiAgICBjbnQrKzsKICAgIH0KICAgIH0KICAgIGlmIChjbnQgPiAyKSB7CiAgICB3cy5zZW5kKCdZb3UgYWxyZWFkeSBvd24gMyBvciBtb3JlIFZJUkNoYXRzIScpCiAgICB9IGVsc2UgewogICAgaWYgKGNoYXRzLmxlbmd0aCA8IDUxKSB7CiAgICBmb3IgKGxldCBjIG9mIGNoYXRzKSB7CiAgICBpZiAoYyA9PT0gY2hhdCkgewogICAgY2hhdCArPSAnICgyKScKICAgIH0KICAgIH0KICAgIGNoYXRzLnB1c2goY2hhdCk7CiAgICBjaGF0SVBzLnB1c2goY2hhdCsnLCcrd3MuaXApCiAgICB3cy5zZW5kKCdTdWNjZXNzZnVsbHkgY3JlYXRlZCBWSVJDaGF0ICInK2NoYXQrJyIuIFVzZSAiL2NoYXQgJytjaGF0KyciIHRvIGNoYW5nZSBjaGF0cy4nKQogICAgfSBlbHNlIHsKICAgIHdzLnNlbmQoJ0ZhaWxlZCB0byBjcmVhdGUgY2hhdDogTWF4aW11bSBsaW1pdCBvZiBWaXJ0dWFsIENoYXRyb29tcyBoYXMgcmVhY2hlZC4gKDUwKScpCiAgICB9CiAgICB9CiAgICB9CiAgICB9IGVsc2UgaWYgKHN0cmluZy5zdGFydHNXaXRoKCcvcmVtb3ZlY2hhdCcpKSB7CiAgICBsZXQgY2hhdCA9IHN0cmluZy5zdWJzdHJpbmcoJy9yZW1vdmVjaGF0ICcubGVuZ3RoKTsKICAgIGlmICghY2hhdCkgewogICAgd3Muc2VuZCgnU3ludGF4OiAvcmVtb3ZlY2hhdCA8Y2hhdD4uIE5vdGU6IFRoaXMgd2lsbCBvbmx5IHdvcmsgd2l0aCBWaXJ0dWFsIENoYXRzIHdoaWNoIHlvdSBvd24uJykKICAgIH0gZWxzZSB7CiAgICBpZiAoY2hhdCA9PT0gJ21haW4nKSB7CiAgICB3cy5zZW5kKCdZb3UgYXJlIG5vdCBhbGxvd2VkIHRvIGRlbGV0ZSB0aGUgbWFpbiBjaGF0cm9vbS4nKQogICAgfSBlbHNlIHsKICAgIGZvciAobGV0IGlwIG9mIGNoYXRJUHMpIHsKICAgIGlmIChpcC5zcGxpdCgnLCcpWzFdID09PSB3cy5pcCAmJiBpcC5zcGxpdCgnLCcpWzBdID09PSBjaGF0KSB7CiAgICBjaGF0SVBzLnNwbGljZShpcCk7CiAgICBjaGF0cy5zcGxpY2UoY2hhdCkKICAgIHdzLnNlbmQoJ1N1Y2Nlc3NmdWxseSBkZWxldGVkIFZpcnR1YWwgQ2hhdHJvb20gIicrY2hhdCsnIi4nKQogICAgYnJvYWRjYXN0KCdUaGUgb3duZXIgZGVsZXRlZCB0aGUgVmlydHVhbCBDaGF0cm9vbS4gWW91IGhhdmUgYmVlbiBtb3ZlZCBiYWNrIHRvIHRoZSBtYWluIGNoYXRyb29tLicsY2hhdCwgdHJ1ZSwgd3MuaWQpOwogICAgZm9yIChsZXQgcCBvZiBjbGllbnRzKSB7CiAgICBpZiAocC5jaGF0ID09PSBjaGF0KSB7CiAgICBwLmNoYXQgPSAnbWFpbic7CiAgICB9CiAgICB9CiAgICB9IGVsc2UgaWYgKGlwLnNwbGl0KCcsJylbMF0gPT09IGNoYXQpIHsKICAgIHdzLnNlbmQoJ1lvdSBjYW5ub3QgZGVsZXRlIHRoaXMgVmlydHVhbCBDaGF0IGJlY2F1c2UgeW91IGRvblwndCBvd24gaXQhJykKICAgIH0KICAgIH0KICAgIH0KICAgIH0KICAgIH0gZWxzZSBpZiAoc3RyaW5nLnN0YXJ0c1dpdGgoJy9jaGF0JykpIHsKICAgIGxldCBjaGF0ID0gc3RyaW5nLnN1YnN0cmluZygnL2NoYXQgJy5sZW5ndGgpOwogICAgaWYgKCFjaGF0KSB7CiAgICB3cy5zZW5kKCdTeW50YXg6IC9jaGF0IDxjaGF0Pi4nKQogICAgfSBlbHNlIHsKICAgIGlmIChjaGF0ID09PSAnbWFpbicpIHsKICAgIGlmICh3cy5jaGF0ID09PSAnbWFpbicpIHsKICAgIHdzLnNlbmQoJ1lvdSBhcmUgYWxyZWFkeSBpbiB0aGlzIGNoYXQhJykKICAgIH0gZWxzZSB7CiAgICAgaWYgKHdzLmRldmVsb3BlciA9PT0gdHJ1ZSAmJiB3cy5uYW1lID09PSAnbG9sOTk5OTInKSB7CiAgICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9ImdyZWVuIj5DaGF0IFJvb20gQnJvYWRjYXN0PC9mb250PjwvYj46IDxzcGFuIGNsYXNzPSJyYWluYm93LXRleHQiPjxiPicrKHdzLm5hbWUgfHwgJzxiPkFuIHVua25vd24gcGVyc29uPC9iPicpKyc8L2I+PC9zcGFuPiBoYXMgbGVmdCB0aGUgY2hhdC48L3NwYW4+Jyl9KSwgd3MuY2hhdCwgdHJ1ZSwgd3MuaWQpCiAgICAgIH0gZWxzZSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJncmVlbiI+Q2hhdCBSb29tIEJyb2FkY2FzdDwvZm9udD48L2I+OiAnKyh3cy5uYW1lIHx8ICc8Yj5BbiB1bmtub3duIHBlcnNvbjwvYj4nKSsnIGhhcyBsZWZ0IHRoZSBjaGF0Ljwvc3Bhbj4nKX0pLCB3cy5jaGF0LCB0cnVlLCB3cy5pZCkKICAgICAgfQogICAgd3Muc2VuZCgnQ2hhbmdlZCBjaGF0cyB0byBtYWluLicpCiAgICB3cy5jaGF0ID0gJ21haW4nOwogICAgaWYgKHdzLmRldmVsb3BlciA9PT0gdHJ1ZSAmJiB3cy5uYW1lID09PSAnbG9sOTk5OTInKSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJncmVlbiI+Q2hhdCBSb29tIEJyb2FkY2FzdDwvZm9udD48L2I+OiA8c3BhbiBjbGFzcz0icmFpbmJvdy10ZXh0Ij48Yj4nKyh3cy5uYW1lIHx8ICc8Yj5BbiB1bmtub3duIHBlcnNvbjwvYj4nKSsnPC9iPjwvc3Bhbj4gaGFzIGpvaW5lZCB0aGUgY2hhdC48L3NwYW4+Jyl9KSwgd3MuY2hhdCwgdHJ1ZSwgd3MuaWQpCiAgICB9IGVsc2UgewogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbSBCcm9hZGNhc3Q8L2ZvbnQ+PC9iPjogJysod3MubmFtZSB8fCAnPGI+QW4gdW5rbm93biBwZXJzb248L2I+JykrJyBoYXMgam9pbmVkIHRoZSBjaGF0Ljwvc3Bhbj4nKX0pLCB3cy5jaGF0LCB0cnVlLCB3cy5pZCkKICAgIH0KICAgIH0KICAgIH0gZWxzZSBpZiAod3MuY2hhdCA9PT0gY2hhdCkgewogICAgd3Muc2VuZCgnWW91IGFyZSBhbHJlYWR5IGluIHRoaXMgY2hhdHJvb20hJykKICAgIH0gZWxzZSBpZiAoY2hhdHMuaW5jbHVkZXMoY2hhdCkpIHsKICAgIGlmICh3cy5kZXZlbG9wZXIgPT09IHRydWUgJiYgd3MubmFtZSA9PT0gJ2xvbDk5OTkyJykgewogICAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJncmVlbiI+Q2hhdCBSb29tIEJyb2FkY2FzdDwvZm9udD48L2I+OiA8c3BhbiBjbGFzcz0icmFpbmJvdy10ZXh0Ij48Yj4nKyh3cy5uYW1lIHx8ICc8Yj5BbiB1bmtub3duIHBlcnNvbjwvYj4nKSsnPC9iPjwvc3Bhbj4gaGFzIGxlZnQgdGhlIGNoYXQuPC9zcGFuPicpfSksIHdzLmNoYXQsIGZhbHNlKQogICAgICB9IGVsc2UgewogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbSBCcm9hZGNhc3Q8L2ZvbnQ+PC9iPjogJysod3MubmFtZSB8fCAnPGI+QW4gdW5rbm93biBwZXJzb248L2I+JykrJyBoYXMgbGVmdCB0aGUgY2hhdC48L3NwYW4+Jyl9KSwgd3MuY2hhdCwgdHJ1ZSwgd3MuaWQpCiAgICAgIH0KICAgIHdzLmNoYXQgPSBjaGF0OwogICAgd3Muc2VuZCgnQ2hhbmdlZCBjaGF0cyB0byAnK2NoYXQrJy4nKTsKICAgIGlmICh3cy5kZXZlbG9wZXIgPT09IHRydWUgJiYgd3MubmFtZSA9PT0gJ2xvbDk5OTkyJykgewogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbSBCcm9hZGNhc3Q8L2ZvbnQ+PC9iPjogPHNwYW4gY2xhc3M9InJhaW5ib3ctdGV4dCI+PGI+Jysod3MubmFtZSB8fCAnPGI+QW4gdW5rbm93biBwZXJzb248L2I+JykrJzwvYj48L3NwYW4+IGhhcyBqb2luZWQgdGhlIGNoYXQuPC9zcGFuPicpfSksIHdzLmNoYXQsIHRydWUsIHdzLmlkKQogICAgfSBlbHNlIHsKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9ImdyZWVuIj5DaGF0IFJvb20gQnJvYWRjYXN0PC9mb250PjwvYj46ICcrKHdzLm5hbWUgfHwgJzxiPkFuIHVua25vd24gcGVyc29uPC9iPicpKycgaGFzIGpvaW5lZCB0aGUgY2hhdC48L3NwYW4+Jyl9KSwgd3MuY2hhdCwgdHJ1ZSwgd3MuaWQpCiAgICB9CiAgICB9IGVsc2UgewogICAgd3Muc2VuZCgnSW52YWxpZCBjaGF0LicpCiAgICB9CiAgICB9CiAgICB9IGVsc2UgaWYgKHN0cmluZy5zdGFydHNXaXRoKCcvZ3Vlc3N0aGVudW1iZXInKSkgewogICAgaWYgKHdzLnNwYW0gPT09IHRydWUpIHsKICAgIG11dGVkSVBTLnB1c2gocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0pCiAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnbXV0ZSd9KSkKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9Im9yYW5nZSI+TW9kZXJhdGlvbiBCb3Q8L2ZvbnQ+PC9iPjogJyt3cy5uYW1lKycgaGFzIGJlZW4gbXV0ZWQgZm9yIDY1IHNlY29uZHMuIFJlYXNvbjogU3BhbS48L3NwYW4+IDxzbWFsbD48c3BhbiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzNCODJGNjsgYm9yZGVyLXJhZGl1czogM3B4OyB1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRoaXMgbWVzc2FnZSB3YXMgc2VudCBmcm9tIGEgcm9ib3QuIj48Zm9udCBjb2xvcj0id2hpdGUiPjxiPuKckyBSb2JvdDwvYj48L2ZvbnQ+PC9zcGFuPjwvc21hbGw+Jyl9KSwgd3MuY2hhdCwgZmFsc2UpCiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIHRyeSB7CiAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnbXV0ZSd9KSkKICAgIG11dGVkSVBTLnNwbGljZShyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10uc3BsaXQoJywnKVswXSkKICAgIH0gY2F0Y2ggKGVycm9yKSB7fSAvLyBJayB0aGF0IGlmIGl0IHdvdWxkdmUgYmVlbiByZWxvYWRlZCwgaXQgd291bGQgdGhyb3cgYSBodWdlIGxpc3Qgb2YgYSBnaWJiZXJpc2ggZXJyb3IgdGhhdCB3b3VsZCBmaWxsIG15IGNvbnNvbGUgc2F5aW5nIHRoZSB3ZWJzb2NrZXQgaXMgY2xvc2VkIGFuZCBhIGJ1bmNoIG9mIHBhdGhzIGkgd29uJ3QgZXZlbiBuZWVkIHRvIGtub3cgbG9sCiAgICB9LCA2NTAwMCk7CiAgICB9IGVsc2UgewogICAgd3Muc3BhbSA9IHRydWU7CiAgICBsZXQgaWQgPSBTdHJpbmcoTWF0aC5yYW5kb20oKSkuc3Vic3RyaW5nKDIpOwogICAgbGV0IGFyZ3MgPSBzdHJpbmcuc3Vic3RyaW5nKCcvZ3Vlc3N0aGVudW1iZXIgJy5sZW5ndGgpCiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICJpbnRlcmFjdGlvbiIsIGlkOiBpZCwgdGV4dDogIi9ndWVzc3RoZW51bWJlciIsIGRlczogIi9ndWVzc3RoZW51bWJlciAiK2AkeyFhcmdzID8gJ1tObyBhcmd1bWVudHMgZ2l2ZW5dJzogYXJnc31gLCBuYW1lOiB3cy5uYW1lfSksIHdzLmNoYXQsIGZhbHNlKTsKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgbGV0IHJhbmdlID0gTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogMTApOwogICAgaWYgKE51bWJlcihhcmdzKSA9PT0gTnVtYmVyKHJhbmdlKSkgewogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAiZW5kaW50ZXJhY3Rpb24iLCBpZDogaWQsIHRleHQ6ICJZb3UgYXJlIGNvcnJlY3QhISBUaGUgYW5zd2VyIHdhcyAiK3JhbmdlKyIuIn0pLCB3cy5jaGF0LCBmYWxzZSk7CiAgICB9IGVsc2UgewogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAiZW5kaW50ZXJhY3Rpb24iLCBpZDogaWQsIHRleHQ6ICJZb3UgYXJlIHdyb25nISEgVGhlIGFuc3dlciB3YXMgIityYW5nZSsiLiJ9KSwgd3MuY2hhdCwgZmFsc2UpOwogICAgfQogICAgfSwgNTAwKTsKICAgIH0KICAgIH0gZWxzZSBpZiAoc3RyaW5nLnN0YXJ0c1dpdGgoJy9yZXBvcnQnKSkgewogICAgbGV0IGEgPSBzdHJpbmcuc3Vic3RyaW5nKCcvcmVwb3J0ICcubGVuZ3RoKTsgLy8gVGFyZ2V0IHRvIHJlcG9ydAogICAgaWYgKCFhKSB7IC8vIFRoZSBwZXJzb24gZGlkIG5vdCBhZGQgYW55dGhpbmcKICAgIHdzLnNlbmQoJ1N5bnRheDogL3JlcG9ydCA8bmFtZT4uIFdBUk5JTkc6IE1pc3VzZS9BYnVzZSBvZiB0aGUgcmVwb3J0aW5nIGZlYXR1cmUgY2FuIHJlc3VsdCBpbiBhIHB1bmlzaG1lbnQhJykKICAgIH0gZWxzZSB7CiAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgIGZvciAobGV0IGMgb2YgY2xpZW50cykgewogICAgaWYgKGMubmFtZSA9PT0gYSAmJiBjLmRldmVsb3BlciA9PT0gdHJ1ZSkgeyAvLyBTb21lb25lIHRyaWVkIHRvIHJlcG9ydCB0aGUgZGV2ZWxvcGVyIGxtYW8KICAgIC8vIE1ha2UgZnVuIG9mIGhpbS4uIHNlY3JldGx5LiBZb3Uga25vdyBob3cuLj8gOgogICAgd3Muc2VuZCgnWW91IGNhbm5vdCByZXBvcnQgdGhlIGRldmVsb3Blci4gV0FSTklORzogTWlzdXNlL0FidXNlIG9mIHRoZSByZXBvcnRpbmcgZmVhdHVyZSBjYW4gcmVzdWx0IGluIGEgcHVuaXNobWVudCEnKSAvLyBIaWRlIHlvdXIgbGF1Z2h0ZXIuLgogICAgLy8gVHVybiBhcm91bmQsIGhpZGUgeW91ciBmYWNlLCBhbmQuLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAgIGNvbnNvbGUubG9nKHdzLm5hbWUudG9VcHBlckNhc2UoKSsnICgnK3dzLmlwKycpIFRSSUVEIFRPIFJFUE9SVCBUSEUgREVWRUxPUEVSIExNQU9PT09PJyk7IC8vIEFBQUFBQUFBQUhBSEFIQUhBSEFIQUhBQUFBQSAoZGllcyBvZiBsYXVnaHRlcikKICAgIGRiLnNlbmQoJzxAMTE5Mzg4MjQ4NDcyNzg4NTg4ND4gKionK3dzLm5hbWUrJyAoJyt3cy5pcCsnKSB0cmllZCB0byByZXBvcnQgeW91ISoqJykKICAgIC8vIChzbmFwKS4uIG5vaWNlLiBOb3cgbGV0J3MgZ2V0IHNlcmlvdXMgZG93biBoZXJlOgogICAgfSBlbHNlIGlmIChjLm5hbWUgPT09IGEpIHsgLy8gRm91bmQgc29tZW9uZSB3aXRoIHRoZSBtYXRjaGluZyBuYW1lLCByZXBvcnQgaGltIHRvIHRoZSBvd25lcgogICAgZm91bmQgPSB0cnVlOwogICAgLy8gc2VuZCwgc2VuZCwgbG9nOyBhbm5vdW5jZSBpdCBldmVyeXdoZXJlIGkgY2FuIGZpbmQgdGhhdCB0aGlzIGR1ZGUgaGFzIHJlcG9ydGVkIHRoZSBvdGhlciBndXkKICAgIGRiLnNlbmQoJzxAMTE5Mzg4MjQ4NDcyNzg4NTg4ND4gKionK3dzLm5hbWUrJyAoJyt3cy5pcCsnKSBoYXMgcmVwb3J0ZWQgJytjLm5hbWUrJyAoJytjLmlwKycpISoqJykKICAgIHdzLnNlbmQoJ1lvdXIgcmVwb3J0IGhhcyBiZWVuIHN1Y2Nlc3NmdWxseSBzdWJtaXR0ZWQuIFdBUk5JTkc6IE1pc3VzZS9BYnVzZSBvZiB0aGUgcmVwb3J0aW5nIGZlYXR1cmUgY2FuIHJlc3VsdCBpbiBhIHB1bmlzaG1lbnQhJykKICAgIGNvbnNvbGUubG9nKHdzLm5hbWUrJyAoJyt3cy5pcCsnKSByZXBvcnRlZCAnK2MubmFtZSsnICgnK2MuaXArJykhJykKICAgIH0KICAgIH0KICAgIGlmIChmb3VuZCA9PT0gZmFsc2UpIHsgLy8gTm8gb25lIGZvdW5kCiAgICB3cy5zZW5kKCdVc2VyIG5vdCBmb3VuZCwgbm8gb25lIHdhcyByZXBvcnRlZC4nKTsgLy8gWWt3IGxldCdzIG5vdCBzY2FyZSBoaW0gYnkgdHJ5aW5nIHRvIGdpdmUgaGltIHRoZSB3YXJuaW5nIG1lc3NhZ2U7IGl0IGNvdWxkIGJlIGEgbWlzdGFrZS4KICAgIGRiLnNlbmQoJzxAMTE5Mzg4MjQ4NDcyNzg4NTg4ND4gKionK3dzLm5hbWUrJyAoJyt3cy5pcCsnKSB0cmllZCB0byByZXBvcnQgJytjLm5hbWUrJywgYnV0IHRoZSB1c2VyIHdhcyBub3QgZm91bmQhKionKQogICAgY29uc29sZS5sb2cod3MubmFtZSsnICgnK3dzLmlwKycpIGF0dGVtcHRlZCB0byByZXBvcnQgJytjLm5hbWUrJywgYnV0IHRoZSBzcGVjaWZpZWQgdXNlciB3YXMgbm90IGZvdW5kLicpCiAgICB9CiAgICB9CiAgICB9IGVsc2UgaWYgKHN0cmluZy5zdGFydHNXaXRoKCcvcmNoYXQnKSkgewogICAgbGV0IGNoYXQgPSBzdHJpbmcuc3Vic3RyaW5nKCcvcmNoYXQgJy5sZW5ndGgpOyAvLyBUYXJnZXQgdG8gcmVwb3J0CiAgICBpZiAoIWNoYXQpIHsgLy8gVGhlIHBlcnNvbiBkaWQgbm90IGFkZCBhbnl0aGluZwogICAgd3Muc2VuZCgnU3ludGF4OiAvcmNoYXQgPGNoYXRuYW1lPi4gRS5nIC9yY2hhdCBteWNoYXQwMDk0MC4gV0FSTklORzogTWlzdXNlL0FidXNlIG9mIHRoaXMgZmVhdHVyZSBjYW4gcmVzdWx0IGluIGEgcHVuaXNobWVudCEnKQogICAgfSBlbHNlIHsKICAgIGxldCBmb3VuZCA9IGZhbHNlOwogICAgZm9yIChsZXQgYyBvZiBjaGF0cykgewogICAgaWYgKGNoYXQgPT09ICdtYWluJykgewogICAgZm91bmQgPSB0cnVlOwogICAgd3Muc2VuZCgnWW91IGNhbm5vdCByZXBvcnQgdGhlIG1haW4gY2hhdCBQbGVhc2UgdXNlIC9yZXBvcnQgPHBlcnNvblwncyBuYW1lPiBpbnN0ZWFkLiBXQVJOSU5HOiBNaXN1c2UvQWJ1c2Ugb2YgdGhpcyBmZWF0dXJlIGNhbiByZXN1bHQgaW4gYSBwdW5pc2htZW50IScpCiAgICBjb25zb2xlLmxvZyh3cy5uYW1lKycgKCcrd3MuaXArJykgdHJpZWQgdG8gcmVwb3J0IHRoZSBtYWluIGRpbWVuc2lvbiwgaGVcJ3MgYSBzdHVwaWQnKTsgLy8gQUFBQUFBQUFBSEFIQUhBSEFIQUhBSEFBQUFBIChkaWVzIG9mIGxhdWdodGVyKQogICAgZGIuc2VuZCgnPEAxMTkzODgyNDg0NzI3ODg1ODg0PiAqKicrd3MubmFtZSsnICgnK3dzLmlwKycpIHRyaWVkIHRvIHJlcG9ydCB0aGUgbWFpbiBjaGF0ISoqJykKICAgIH0gZWxzZSB7CiAgICBpZiAoYyA9PT0gY2hhdCkgewogICAgZm91bmQgPSB0cnVlOwogICAgLy8gc2VuZCwgc2VuZCwgbG9nOyBhbm5vdW5jZSBpdCBldmVyeXdoZXJlIGkgY2FuIGZpbmQgdGhhdCB0aGlzIGR1ZGUgaGFzIHJlcG9ydGVkIGEgVklSQ2hhdAogICAgbGV0IElQcyA9IFtdCiAgICBmb3IgKGxldCB3ZSBvZiBjbGllbnRzKSB7IAogICAgaWYgKHdlLmNoYXQgPT09IGNoYXQpIHsKICAgIElQcy5wdXNoKCcqKklQKio6ICcrd2UuaXArJywgKipOYW1lKio6ICcrd2UubmFtZSkKICAgIH0KICAgIH0KICAgIGRiLnNlbmQoJzxAMTE5Mzg4MjQ4NDcyNzg4NTg4ND4gKionK3dzLm5hbWUrJyAoJyt3cy5pcCsnKSBoYXMgcmVwb3J0ZWQgVklSQ2hhdCAnK2MrJyEqKlxuXG4qKklQIEFkZHJlc3NlcyBvZiBhbGwgcGVvcGxlIGluIHRoZSByZXBvcnRlZCBjaGF0OioqXG4nK0lQcy5qb2luKCdcbicpKQogICAgd3Muc2VuZCgnWW91ciBWSVJDaGF0IHJlcG9ydCBoYXMgYmVlbiBzdWNjZXNzZnVsbHkgc3VibWl0dGVkLiBXQVJOSU5HOiBNaXN1c2UvQWJ1c2Ugb2YgdGhpcyBmZWF0dXJlIGNhbiByZXN1bHQgaW4gYSBwdW5pc2htZW50IScpCiAgICBjb25zb2xlLmxvZyh3cy5uYW1lKycgKCcrd3MuaXArJykgcmVwb3J0ZWQgY2hhdCAnK2MrJyEnKQogICAgfSAKICAgIH0KICAgIH0KICAgIGlmIChmb3VuZCA9PT0gZmFsc2UpIHsgLy8gTm8gb25lIGZvdW5kCiAgICB3cy5zZW5kKCdWSVJDaGF0IG5vdCBmb3VuZCwgZmFpbGVkIHRvIHJlcG9ydC4nKTsgLy8gWWt3IGxldCdzIG5vdCBzY2FyZSBoaW0gYnkgdHJ5aW5nIHRvIGdpdmUgaGltIHRoZSB3YXJuaW5nIG1lc3NhZ2U7IGl0IGNvdWxkIGJlIGEgbWlzdGFrZS4KICAgIGRiLnNlbmQoJzxAMTE5Mzg4MjQ4NDcyNzg4NTg4ND4gKionK3dzLm5hbWUrJyAoJyt3cy5pcCsnKSB0cmllZCB0byByZXBvcnQgVklSQ2hhdCAnK2NoYXQrJywgYnV0IHRoZSBWSVJDaGF0IHdhcyBub3QgZm91bmQhKionKQogICAgY29uc29sZS5sb2cod3MubmFtZSsnICgnK3dzLmlwKycpIGF0dGVtcHRlZCB0byByZXBvcnQgJytjaGF0KycsIGJ1dCB0aGUgc3BlY2lmaWVkIFZJUkNoYXQgd2FzIG5vdCBmb3VuZC4nKQogICAgfQogICAgfQogICAgfSBlbHNlIGlmIChzdHJpbmcuc3RhcnRzV2l0aCgnL2V2YWwnKSAmJiB3cy5kZXZlbG9wZXIgPT09IHRydWUpIHsKICAgIHRyeSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJncmVlbiI+Q2hhdCBSb29tIEJyb2FkY2FzdDwvZm9udD48L2I+OiA8aT5FdmFsIE91dHB1dDo8L2k+ICcrZXZhbChzdHJpbmcuc3Vic3RyaW5nKCcvZXZhbCAnLmxlbmd0aCkpKycgPC9zcGFuPicpfSksIHdzLmNoYXQsIGZhbHNlKQogICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9ImdyZWVuIj5DaGF0IFJvb20gQnJvYWRjYXN0PC9mb250PjwvYj46IDxpPkV2YWwgT3V0cHV0IDxzbWFsbD4oRXJyb3IpPC9zbWFsbD46PC9pPiAnK2Vycm9yLm1lc3NhZ2UrJyA8L3NwYW4+Jyl9KSwgd3MuY2hhdCwgZmFsc2UpCiAgICB9CiAgICB9IGVsc2UgaWYgKHN0cmluZy5zdGFydHNXaXRoKCcvYnJvYWRjYXN0JykgJiYgd3MuZGV2ZWxvcGVyID09PSB0cnVlKSB7CiAgICBsZXQgbSA9IHN0cmluZy5zdWJzdHJpbmcoJy9icm9hZGNhc3QgJy5sZW5ndGgpOwogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbSBCcm9hZGNhc3Q8L2ZvbnQ+PC9iPjogJyttKyc8L3NwYW4+Jyl9KSwgd3MuY2hhdCwgZmFsc2UpCiAgICB9IGVsc2UgeyAvLyBJIGdvdHRhIGdldCBteSBicmFpbiB0byB0aGluayBhYm91dCByYWNpYWwgc2x1cnMgb3IgbGluZXMgd2hpY2ggY2FuIGJlIDEwMCUgaWRlbnRpZmllZCBhcyByYWNpc20KICAgIGxldCBzbHVycyA9IFsnbmlnZ2EnLCAnbmlnZ2VyJywgJ25pZ2dlJ10KICAgIGlmICh3cy5zcGFtID09PSB0cnVlKSB7CiAgICBtdXRlZElQUy5wdXNoKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKQogICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ211dGUnfSkpCiAgICB3cy5zcGFtV2FybmluZ3MgKz0gMTsKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9Im9yYW5nZSI+TW9kZXJhdGlvbiBCb3Q8L2ZvbnQ+PC9iPjogJyt3cy5uYW1lKycgaGFzIGJlZW4gbXV0ZWQgJytgJHt3cy5zcGFtV2FybmluZ3MgPiAxMCA/ICdmb3IgMTAgbWludXRlcycgOiB3cy5zcGFtV2FybmluZ3MgPiA0ID8gJ2ZvciA1IG1pbnV0ZXMnIDogJ2ZvciAzMCBzZWNvbmRzJ31gKycuIFJlYXNvbjogU3VzcGVjdGVkIHNwYW0uPC9zcGFuPiA8c21hbGw+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMzQjgyRjY7IGJvcmRlci1yYWRpdXM6IDNweDsgdXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUaGlzIG1lc3NhZ2Ugd2FzIHNlbnQgZnJvbSBhIHJvYm90LiI+PGZvbnQgY29sb3I9IndoaXRlIj48Yj7inJMgUm9ib3Q8L2I+PC9mb250Pjwvc3Bhbj48L3NtYWxsPicpfSksIHdzLmNoYXQsIGZhbHNlKQogICAgaWYgKHdzLnNwYW1XYXJuaW5ncyA+IDEwKSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJvcmFuZ2UiPk1vZGVyYXRpb24gQm90PC9mb250PjwvYj46ICcrd3MubmFtZSsnLCB5b3UgZ290IGEgPGI+MTAgbWludXRlPC9iPiBtdXRlLCBnb29kIGpvYiE8L3NwYW4+IDxzbWFsbD48c3BhbiBzdHlsZT0iYmFja2dyb3VuZC1jb2xvcjogIzNCODJGNjsgYm9yZGVyLXJhZGl1czogM3B4OyB1c2VyLXNlbGVjdDogbm9uZTsgY3Vyc29yOiBwb2ludGVyOyIgdGl0bGU9IlRoaXMgbWVzc2FnZSB3YXMgc2VudCBmcm9tIGEgcm9ib3QuIj48Zm9udCBjb2xvcj0id2hpdGUiPjxiPuKckyBSb2JvdDwvYj48L2ZvbnQ+PC9zcGFuPjwvc21hbGw+Jyl9KSwgd3MuY2hhdCwgZmFsc2UpCiAgICB9CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIHRyeSB7CiAgICBpZiAod3Muc3BhbVdhcm5pbmdzIDwgNCkgewogICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ211dGUnfSkpCiAgICBtdXRlZElQUy5zcGxpY2UocmVxLmhlYWRlcnNbJ3gtZm9yd2FyZGVkLWZvciddLnNwbGl0KCcsJylbMF0pCiAgICB9IGVsc2UgaWYgKHdzLnNwYW1XYXJuaW5ncyA+IDEwKSB7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdtdXRlJ30pKQogICAgbXV0ZWRJUFMuc3BsaWNlKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKQogICAgfSwgMzAwMDAwKQogICAgfSBlbHNlIGlmICh3cy5zcGFtV2FybmluZ3MgPiA1KSB7CiAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdtdXRlJ30pKQogICAgbXV0ZWRJUFMuc3BsaWNlKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKQogICAgfSwgMjcwMDAwKQogICAgfQogICAgfSBjYXRjaCAoZXJyb3IpIHt9IC8vIElrIHRoYXQgaWYgaXQgd291bGR2ZSBiZWVuIHJlbG9hZGVkLCBpdCB3b3VsZCB0aHJvdyBhIGh1Z2UgbGlzdCBvZiBhIGdpYmJlcmlzaCBlcnJvciB0aGF0IHdvdWxkIGZpbGwgbXkgY29uc29sZSBzYXlpbmcgdGhlIHdlYnNvY2tldCBpcyBjbG9zZWQgYW5kIGEgYnVuY2ggb2YgcGF0aHMgaSB3b24ndCBldmVuIG5lZWQgdG8ga25vdyBsb2wKICAgIH0sIDMwMDAwKTsKICAgIH0gZWxzZSB7CiAgICBsZXQgZm91bmQgPSBmYWxzZTsKICAgIGZvciAobGV0IHNsdXIgb2Ygc2x1cnMpIHsKICAgIGlmIChTdHJpbmcobWVzc2FnZSkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhzbHVyKSAmJiBmb3VuZCA9PT0gZmFsc2UgJiYgIW11dGVkSVBTLmluY2x1ZGVzKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKSkgewogICAgZm91bmQgPSB0cnVlOwogICAgbXV0ZWRJUFMucHVzaChyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10uc3BsaXQoJywnKVswXSkKICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdtdXRlJ30pKQogICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0ib3JhbmdlIj5Nb2RlcmF0aW9uIEJvdDwvZm9udD48L2I+OiAnK3dzLm5hbWUrJyBoYXMgYmVlbiBtdXRlZCBmb3IgNzAgc2Vjb25kcy4gUmVhc29uOiBTYXlpbmcgYSBzbHVyLjwvc3Bhbj4gPHNtYWxsPjxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjM0I4MkY2OyBib3JkZXItcmFkaXVzOiAzcHg7IHVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVGhpcyBtZXNzYWdlIHdhcyBzZW50IGZyb20gYSByb2JvdC4iPjxmb250IGNvbG9yPSJ3aGl0ZSI+PGI+4pyTIFJvYm90PC9iPjwvZm9udD48L3NwYW4+PC9zbWFsbD4nKX0pLCB3cy5jaGF0LCBmYWxzZSkKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgdHJ5IHsKICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdtdXRlJ30pKQogICAgbXV0ZWRJUFMuc3BsaWNlKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKQogICAgfSBjYXRjaCAoZXJyb3IpIHt9IC8vIElrIHRoYXQgaWYgaXQgd291bGR2ZSBiZWVuIHJlbG9hZGVkLCBpdCB3b3VsZCB0aHJvdyBhIGh1Z2UgbGlzdCBvZiBhIGdpYmJlcmlzaCBlcnJvciB0aGF0IHdvdWxkIGZpbGwgbXkgY29uc29sZSBzYXlpbmcgdGhlIHdlYnNvY2tldCBpcyBjbG9zZWQgYW5kIGEgYnVuY2ggb2YgcGF0aHMgaSB3b24ndCBldmVuIG5lZWQgdG8ga25vdyBsb2wKICAgIH0sIDcwMDAwKTsKICAgIH0KICAgIH0KICAgIGlmIChTdHJpbmcobWVzc2FnZSkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcygnc2V4JykgJiYgZm91bmQgPT09IGZhbHNlICYmICFtdXRlZElQUy5pbmNsdWRlcyhyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10uc3BsaXQoJywnKVswXSkpIHsKICAgIHdzLnNleGNvdW50ICs9IDE7CiAgICBmb3VuZCA9IHRydWU7CiAgICBtdXRlZElQUy5wdXNoKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKQogICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ211dGUnfSkpCiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJvcmFuZ2UiPk1vZGVyYXRpb24gQm90PC9mb250PjwvYj46ICcrd3MubmFtZSsnIGhhcyBiZWVuIG11dGVkIGZvciAyNSBzZWNvbmRzLiBSZWFzb246IGRvbnQgc2F5IHRoYXQgaGVyZSwgYnJvIHBscyBzdG9wIHRoaXMgaXMgbm90IHRoLi4uIDxzbWFsbD48aT4oQ3JvcHBlZCByZWFzb24uIFRleHQgdG9vIGxvbmcuKTwvaT48L3NtYWxsPjwvc3Bhbj4gPHNtYWxsPjxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjM0I4MkY2OyBib3JkZXItcmFkaXVzOiAzcHg7IHVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVGhpcyBtZXNzYWdlIHdhcyBzZW50IGZyb20gYSByb2JvdC4iPjxmb250IGNvbG9yPSJ3aGl0ZSI+PGI+4pyTIFJvYm90PC9iPjwvZm9udD48L3NwYW4+PC9zbWFsbD4nKX0pLCB3cy5jaGF0LCBmYWxzZSkKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgaWYgKHdzLnNleGNvdW50ID09PSAzKSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJvcmFuZ2UiPk1vZGVyYXRpb24gQm90PC9mb250PjwvYj46ICcrd3MubmFtZSsiJyIrJ3Mgbm90IGdvbm5hIHN0b3AgbG1hbyBoZSBsb3ZlcyBhbGwgb2YgdGhpcyBzdHVmZjwvc3Bhbj4gPHNtYWxsPjxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjM0I4MkY2OyBib3JkZXItcmFkaXVzOiAzcHg7IHVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVGhpcyBtZXNzYWdlIHdhcyBzZW50IGZyb20gYSByb2JvdC4iPjxmb250IGNvbG9yPSJ3aGl0ZSI+PGI+4pyTIFJvYm90PC9iPjwvZm9udD48L3NwYW4+PC9zbWFsbD4nKX0pLCB3cy5jaGF0LCBmYWxzZSkKICAgIH0gZWxzZSBpZiAod3Muc2V4Y291bnQgPT09IDgpIHsKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9Im9yYW5nZSI+TW9kZXJhdGlvbiBCb3Q8L2ZvbnQ+PC9iPjogJyt3cy5uYW1lKycgb2theSEgaSBhbSBjaGlsbGVkIG91dCEga2VlcCBnb2luZywgaWRyYy4uPC9zcGFuPiA8c21hbGw+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMzQjgyRjY7IGJvcmRlci1yYWRpdXM6IDNweDsgdXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUaGlzIG1lc3NhZ2Ugd2FzIHNlbnQgZnJvbSBhIHJvYm90LiI+PGZvbnQgY29sb3I9IndoaXRlIj48Yj7inJMgUm9ib3Q8L2I+PC9mb250Pjwvc3Bhbj48L3NtYWxsPicpfSksIHdzLmNoYXQsIGZhbHNlKQogICAgfSBlbHNlIGlmICh3cy5zZXhjb3VudCA9PT0gMTIpIHsKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9Im9yYW5nZSI+TW9kZXJhdGlvbiBCb3Q8L2ZvbnQ+PC9iPjogJyt3cy5uYW1lLnRvVXBwZXJDYXNlKCkrJyBKVVNUIENVVCBJVCBPVVQgQUxSRUFEWSBJTSBUSVJFRCBPRiBHSVZJTkcgWU9VIE1VVEVTISEhPC9zcGFuPiA8c21hbGw+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMzQjgyRjY7IGJvcmRlci1yYWRpdXM6IDNweDsgdXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUaGlzIG1lc3NhZ2Ugd2FzIHNlbnQgZnJvbSBhIHJvYm90LiI+PGZvbnQgY29sb3I9IndoaXRlIj48Yj7inJMgUm9ib3Q8L2I+PC9mb250Pjwvc3Bhbj48L3NtYWxsPicpfSksIHdzLmNoYXQsIGZhbHNlKQogICAgfSBlbHNlIGlmICh3cy5zZXhjb3VudCA9PT0gMTgpIHsKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ3N5c3RlbScsIHRleHQ6IFN0cmluZygnPHNwYW4gc3R5bGU9InVzZXItc2VsZWN0OiBub25lOyI+PGI+PGZvbnQgY29sb3I9Im9yYW5nZSI+TW9kZXJhdGlvbiBCb3Q8L2ZvbnQ+PC9iPjogJyt3cy5uYW1lKycgaSBnaXZlIHVwLCBpIHdvbnQgc2F5IGFueXRoaW5nIG5vdyA6KDwvc3Bhbj4gPHNtYWxsPjxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAjM0I4MkY2OyBib3JkZXItcmFkaXVzOiAzcHg7IHVzZXItc2VsZWN0OiBub25lOyBjdXJzb3I6IHBvaW50ZXI7IiB0aXRsZT0iVGhpcyBtZXNzYWdlIHdhcyBzZW50IGZyb20gYSByb2JvdC4iPjxmb250IGNvbG9yPSJ3aGl0ZSI+PGI+4pyTIFJvYm90PC9iPjwvZm9udD48L3NwYW4+PC9zbWFsbD4nKX0pLCB3cy5jaGF0LCBmYWxzZSkKICAgIH0gZWxzZSBpZiAod3Muc2V4Y291bnQgPT09IDM1KSB7CiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdzeXN0ZW0nLCB0ZXh0OiBTdHJpbmcoJzxzcGFuIHN0eWxlPSJ1c2VyLXNlbGVjdDogbm9uZTsiPjxiPjxmb250IGNvbG9yPSJvcmFuZ2UiPk1vZGVyYXRpb24gQm90PC9mb250PjwvYj46ICcrd3MubmFtZSsnIG9rIGkgbGllZCBidXQgaSBwcm9taXNlIHRoaXMgaXMgMTAwJSB0aGUgdmVyeSBsYXN0IG1lc3NhZ2UgaW0gc2F5aW5nLi4uPC9zcGFuPiA8c21hbGw+PHNwYW4gc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICMzQjgyRjY7IGJvcmRlci1yYWRpdXM6IDNweDsgdXNlci1zZWxlY3Q6IG5vbmU7IGN1cnNvcjogcG9pbnRlcjsiIHRpdGxlPSJUaGlzIG1lc3NhZ2Ugd2FzIHNlbnQgZnJvbSBhIHJvYm90LiI+PGZvbnQgY29sb3I9IndoaXRlIj48Yj7inJMgUm9ib3Q8L2I+PC9mb250Pjwvc3Bhbj48L3NtYWxsPicpfSksIHdzLmNoYXQsIGZhbHNlKQogICAgfQogICAgfSwgNTAwKTsKICAgIHNldFRpbWVvdXQoKCkgPT4gewogICAgdHJ5IHsKICAgIHdzLnNlbmQoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdtdXRlJ30pKQogICAgbXV0ZWRJUFMuc3BsaWNlKHJlcS5oZWFkZXJzWyd4LWZvcndhcmRlZC1mb3InXS5zcGxpdCgnLCcpWzBdKQogICAgfSBjYXRjaCAoZXJyb3IpIHt9IC8vIElrIHRoYXQgaWYgaXQgd291bGR2ZSBiZWVuIHJlbG9hZGVkLCBpdCB3b3VsZCB0aHJvdyBhIGh1Z2UgbGlzdCBvZiBhIGdpYmJlcmlzaCBlcnJvciB0aGF0IHdvdWxkIGZpbGwgbXkgY29uc29sZSBzYXlpbmcgdGhlIHdlYnNvY2tldCBpcyBjbG9zZWQgYW5kIGEgYnVuY2ggb2YgcGF0aHMgaSB3b24ndCBldmVuIG5lZWQgdG8ga25vdyBsb2wKICAgIH0sIDI1MDAwKTsKICAgIH0KICAgIGlmIChmb3VuZCA9PT0gZmFsc2UpIHsKICAgIGlmICghd3MubmFtZSB8fCBtdXRlZElQUy5pbmNsdWRlcyhyZXEuaGVhZGVyc1sneC1mb3J3YXJkZWQtZm9yJ10uc3BsaXQoJywnKVswXSkpIHsKICAgIAogICAgfSBlbHNlIHsKICAgIGxldCBkZXYgPSBmYWxzZTsKICAgIGZvciAobGV0IGlwIG9mIGNoYXRJUHMpIHsKICAgIGlmIChpcC5zcGxpdCgnLCcpWzFdID09PSB3cy5pcCAmJiBpcC5zcGxpdCgnLCcpWzBdID09PSB3cy5jaGF0KSB7CiAgICBkZXYgPSB0cnVlOwogICAgfQogICAgfQogICAgaWYgKGRldiA9PT0gdHJ1ZSkgewogICAgY29uc29sZS5sb2coU3RyaW5nKHdzLm5hbWUrJzogJyttZXNzYWdlKSkKICAgIGJyb2FkY2FzdChKU09OLnN0cmluZ2lmeSh7dHlwZTogJ2NoYXRvd25lcicsIHRleHQ6IFN0cmluZyhtZXNzYWdlKSwgbmFtZTogd3MubmFtZX0pLCB3cy5jaGF0LCBmYWxzZSkKICAgIH0gZWxzZSBpZiAod3MuZGV2ZWxvcGVyID09PSB0cnVlICYmIHdzLm5hbWUgPT09ICdsb2w5OTk5MicpIHsKICAgIGNvbnNvbGUubG9nKFN0cmluZyh3cy5uYW1lKyc6ICcrbWVzc2FnZSkpCiAgICBicm9hZGNhc3QoSlNPTi5zdHJpbmdpZnkoe3R5cGU6ICdkZXYnLCB0ZXh0OiBTdHJpbmcobWVzc2FnZSksIG5hbWU6IHdzLm5hbWV9KSwgd3MuY2hhdCwgZmFsc2UpCiAgICB9IGVsc2UgewogICAgY29uc29sZS5sb2coU3RyaW5nKHdzLm5hbWUrJzogJyttZXNzYWdlKSkKICAgIGlmIChtZXNzYWdlLmxlbmd0aCA+IDEwMCkgewogICAgY29uc29sZS5sb2coJ01lc3NhZ2UgdG9vIGxvbmchIE1heWJlIGJybyBpcyB1c2luZyBhIGRlYnVnZ2VyPycpCiAgICB3cy5zZW5kKCdEVURFIEFSRSBZT1UgVVNJTkcgQSBERUJVR0dFUj8gTCBkZWJ1Z2dlciBvciBjb25zb2xlIG9yIHUgc29tZWhvdyBicm9rZSB0aHJvdWdoIHRoZSBsaW1pdCBidXQgaW0gZ29ubmEgbm90IGxldCB5b3UgZG8gdGhhdCA6KScpCiAgICB9IGVsc2UgewogICAgYnJvYWRjYXN0KFN0cmluZyh3cy5uYW1lKyc6ICcrbWVzc2FnZSksIHdzLmNoYXQsIGZhbHNlKQogICAgfQogICAgfQogICAgfQogICAgfQogICAgfQogICAgICB3cy5zcGFtID0gdHJ1ZTsKICAgIH0KICAgIH0pOwoKICAgIC8vIEhhbmRsZSBjbGllbnQgZGlzY29ubmVjdGlvbnMKICAgIHdzLm9uKCdjbG9zZScsICgpID0+IHsKICAgICAgLy8gZGFtbiBpdCB3ZSBsb3N0IGEgY2xpZW50ISEgOigKICAgICAgY29uc29sZS5sb2coJ0EgY2xpZW50IGRpc2Nvbm5lY3RlZCEnKQogICAgICBpZiAod3MubmFtZSkgewogICAgICBpZiAod3MuZGV2ZWxvcGVyID09PSB0cnVlICYmIHdzLm5hbWUgPT09ICdsb2w5OTk5MicpIHsKICAgICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbSBCcm9hZGNhc3Q8L2ZvbnQ+PC9iPjogPHNwYW4gY2xhc3M9InJhaW5ib3ctdGV4dCI+PGI+Jysod3MubmFtZSB8fCAnPGI+QW4gdW5rbm93biBwZXJzb248L2I+JykrJzwvYj48L3NwYW4+IGhhcyBsZWZ0IHRoZSBjaGF0Ljwvc3Bhbj4nKX0pLCB3cy5jaGF0LCBmYWxzZSkKICAgICAgfSBlbHNlIHsKICAgICAgYnJvYWRjYXN0KEpTT04uc3RyaW5naWZ5KHt0eXBlOiAnc3lzdGVtJywgdGV4dDogU3RyaW5nKCc8c3BhbiBzdHlsZT0idXNlci1zZWxlY3Q6IG5vbmU7Ij48Yj48Zm9udCBjb2xvcj0iZ3JlZW4iPkNoYXQgUm9vbSBCcm9hZGNhc3Q8L2ZvbnQ+PC9iPjogJysod3MubmFtZSB8fCAnPGI+QW4gdW5rbm93biBwZXJzb248L2I+JykrJyBoYXMgbGVmdCB0aGUgY2hhdC48L3NwYW4+Jyl9KSwgd3MuY2hhdCwgZmFsc2UpCiAgICAgIH0KICAgICAgdXNlcnMuc3BsaWNlKHdzLm5hbWUpCiAgICAgIH0KICAgIH0pOwoKICAgIHdzLm9uKCdlcnJvcicsIChlcnJvcikgPT4gewogICAgICAgIGNvbnNvbGUuZXJyb3IoJ1dlYlNvY2tldCBlcnJvcjonLCBlcnJvcik7CiAgICAgIC8vIE9oIHNoaXQgZGVidWcgdGhpcyBFc2NsaXBweSBwbGVhc2UKICAgIH0pOwp9KQovLyBTdGFydCB0aGUgc2VydmVyIG9uIHBvcnQgMzAwMApzZXJ2ZXIubGlzdGVuKDMwMDAsICgpID0+IHsKICAgIC8vIFlFQUhISEhISEhISEhISFtISEhISEhISEhISEhISEhISEhISEhISEgKICAgIGNvbnNvbGUubG9nKCdIdHRwICsgV2ViU29ja2V0IHNlcnZlciBpcyBzdWNjZXNzZnVsbHkgdHVybmVkIG9uISBXYWl0aW5nIGZvciBjb25uZWN0aW9ucy9yZWNvbm5lY3Rpb25zLicpOwp9KTsKfSk="
url=http://de1.bot-hosting.net:20558
base64ToText=https://abounding-treasure-forger.glitch.me/